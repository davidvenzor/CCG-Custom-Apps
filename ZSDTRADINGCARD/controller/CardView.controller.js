sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/m/PDFViewer","sap/m/Dialog","sap/m/Button","sap/m/library","sap/ui/core/BusyIndicator","sap/ui/core/routing/History","ccgtradingcards/utils/formatter"],function(e,t,i,s,a,r,d,l,o,n,g,u,h,C){"use strict";return e.extend("ccgtradingcards.controller.CardView",{formatter:C,onInit:function(){this.oModel=this.getOwnerComponent().getModel("SC");this.oModel_SC=this.getOwnerComponent().getModel("SC");this.oModel_SC.attachRequestSent(this.onRequestSent,this);this.oModel_SC.attachRequestCompleted(this.onRequestCompleted,this);this.getView().byId("idMsdGradTab").setText("Missed Grading");this.getView().byId("idFinish").setSelected(false);var e=new sap.ui.model.json.JSONModel;this.getView().setModel(e,"GradeSetModel");var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"NoGradeModel");var i=new sap.ui.model.json.JSONModel;this.getView().setModel(i,"AutoGradeModel");var s=new sap.ui.model.json.JSONModel;this.getView().setModel(s,"CenterModel");var r=new sap.ui.model.json.JSONModel;this.getView().setModel(r,"CornerModel");var d=new sap.ui.model.json.JSONModel;this.getView().setModel(d,"EdgeModel");var l=new sap.ui.model.json.JSONModel;this.getView().setModel(l,"SurfaceModel");var o=new sap.ui.model.json.JSONModel;this.getView().setModel(o,"InitModel");var n=new sap.ui.model.json.JSONModel;this.getView().setModel(n,"ErrorModel");var g=new sap.ui.model.json.JSONModel;this.getView().setModel(g,"DefectModel");var u=new sap.ui.model.json.JSONModel;this.getView().setModel(u,"pInitModel");var h=new sap.ui.model.json.JSONModel;var C=this.getOwnerComponent().getModel("SC");this.oModel_SC.read("/Grade_gradeSet",{success:function(e,t){this.setDropdownValues(e.results,"A")}.bind(this),error:function(){a.show("Sub-Grades failed to Load, Please Contact Technical Team")}});var S=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.oSalesID),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.oLineId)];var c=[new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"I")];C.read("/getInitialLineItemsSet",{filters:c,success:function(e,t){h.setData(e);this.getView().getModel("InitModel").setData(e.results);this.getView().getModel("InitModel").refresh()}.bind(this),error:function(){}});this.onRefreshSo();var V=new sap.ui.model.json.JSONModel;this.getView().setModel(V,"SC_oMaraTempModel");var b={Matnr:" ",Maktx:" ",ZCsgSportsCode:" ",ZCsgMakerCode:" ",ZCsgSetCode:" ",ZCardYear:" ",ZPlayer:" ",ZPrntdAutographFlag:" ",ZCsgCardAttrib1Descr:" ",ZCsgCardAttrib2Descr:" "};this.getView().getModel("SC_oMaraTempModel").setData(b);this.getView().getModel("SC_oMaraTempModel").refresh()},onRequestSent:function(){sap.ui.core.BusyIndicator.show()},onRequestCompleted:function(){if(!this.oModel_SC.hasPendingChanges()){sap.ui.core.BusyIndicator.hide()}},setDropdownValues:function(e,t){var i=[];var s=[];var a=[];var r=[];var d=[];var l=[];e.forEach(function(e){if(e.ImFlag=="G"){i.push(e)}else if(e.ImFlag=="N"){s.push(e)}else if(e.ImFlag=="A"){a.push(e)}else if(e.ImFlag=="C"){d.push(e)}else if(e.ImFlag=="E"){l.push(e)}else if(e.ImFlag=="D"){r.push(e)}else if(e.ImFlag=="S"){}});if(t=="E"){this.getView().getModel("ErrorModel").setData(l);this.getView().getModel("ErrorModel").refresh()}else{this.getView().getModel("GradeSetModel").setData(i);this.getView().getModel("GradeSetModel").refresh();this.getView().getModel("NoGradeModel").setData(s);this.getView().getModel("NoGradeModel").refresh();this.getView().getModel("AutoGradeModel").setData(a);this.getView().getModel("AutoGradeModel").refresh();this.getView().getModel("DefectModel").setData(r);this.getView().getModel("DefectModel").refresh();this.getView().getModel("ErrorModel").setData(l);this.getView().getModel("ErrorModel").refresh();this.getView().getModel("CenterModel").setData(d);this.getView().getModel("CenterModel").refresh();this.getView().getModel("CornerModel").setData(d);this.getView().getModel("CornerModel").refresh();this.getView().getModel("EdgeModel").setData(d);this.getView().getModel("EdgeModel").refresh();this.getView().getModel("SurfaceModel").setData(d);this.getView().getModel("SurfaceModel").refresh()}},ErrorDropdown:function(e){this.oModel.read("/Grade_gradeSet",{success:function(t,i){this.setDropdownValues(t.results,"E");if(e){this.getView().getModel("MainModel").setData(e.results[0]);this.getView().getModel("MainModel").refresh()}}.bind(this),error:function(){}})},errorDropdownFlt:function(e){var t=[];e.forEach(function(e){if(e.ImFlag=="G"){t.push(e)}});this.getView().getModel("ErrorModel").setData(t);this.getView().getModel("ErrorModel").refresh()},onRefreshSo:function(e){this.getView().byId("idSalesOrder").setSelectedKey("");this.getView().byId("idLineItem").setSelectedKey("");var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"initMaraData");var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"I")];s.read("/getInitialLineItemsSet",{filters:a,success:function(e,t){i.setData(e);e.results.sort(function(e,t){return e.Posnr-t.Posnr});this.getView().getModel("InitModel").setData(e.results);this.getView().getModel("InitModel").refresh()}.bind(this),error:function(){}})},onLineitemFetch:function(e){var t=this.getView().byId("idSalesOrder").getValue();var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=new sap.ui.model.json.JSONModel;this.getView().setModel(a,"InitModel");var d=new sap.ui.model.json.JSONModel;var l=this.getOwnerComponent().getModel("SC");var o=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,t),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"P")];l.read("/getInitialLineItemsSet",{filters:o,success:function(e,t){d.setData(e);if(e.results.length===0){r.error("Please select Valid Sales Order number")}this.getView().getModel("InitModel").setData(e.results);this.getView().getModel("InitModel").refresh();this.getView().getModel("pInitModel").setData(e.results);this.getView().getModel("pInitModel").refresh();var i=new sap.ui.model.json.JSONModel(e.results);this.getView().setModel(i,"olineItem")}.bind(this),error:function(){}})},onFetchDetailsValidate:function(e){var t=this;this.getView().byId("idLineItem").setValue(e);this.getView().byId("idLineItem").setSelectedKey(e);this.SalesId=this.getView().byId("idSalesOrder").getValue();var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,e),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"F")];this.oModel_SC.read("/getInitialLineItemsSet",{filters:s,success:function(i,s){t.onFetchDetailsTSViewDetails(i.results[0].Status,e)}})},OnGradeSel:function(e){var t=this;var i=this.getView().byId("idGrade").getValue();if(!isNaN(parseFloat(i))&&isFinite(i)){this.kgrade=e.getParameters().selectedItem.getText();var s=e.getParameter("selectedItem").getAdditionalText();this.getView().getModel("MainModel").getData().gradedec=s;this.getView().getModel("MainModel").getData().Grade=this.kgrade;this.getView().getModel("MainModel").refresh();if(this.kgrade=="10"&&(s=="PRISTINE"||s=="Pristine")){this.GradeChek="PRISTINE"}else if(this.kgrade=="10"&&(s=="PERFECT"||s=="Perfect")){this.GradeChek="PERFECT"}else if(this.kgrade=="10"){this.GradeChek="GEM MINT"}}},OnGradeSel_TC:function(){var e=this;var t=this.getView().byId("idGrade").getValue();var i=this.getView().getModel("GradeSetModel").getData();if(!isNaN(parseFloat(t))&&isFinite(t)){i.every(i=>{if(i.CharValue==t){e.GradeValidationTC=" ";return false}else{e.GradeValidationTC="X";return true}});if(e.GradeValidationTC=="X"){r.error("Please select the valid Grade");e.getView().byId("idGrade").setSelectedKey("");e.getView().byId("idGrade").setValue("");e.getView().getModel("MainModel").getData().gradedec="";e.getView().getModel("MainModel").getData().Grade="";e.getView().getModel("MainModel").refresh()}}else{r.error("Characters are not allowed in Grade. please select from dropdown",{onClose:function(t){e.getView().byId("idGrade").setSelectedKey("");e.getView().byId("idGrade").setValue("");e.getView().getModel("MainModel").getData().gradedec="";e.getView().getModel("MainModel").getData().Grade="";e.getView().getModel("MainModel").refresh()}})}},setScreen(e){if(e==="T"){this.getView().byId("tradingCardIdPanel").setVisible(true);this.getView().byId("SportsCardIdPanel").setVisible(false);this.getView().byId("TC_HdrTbr").setVisible(true);this.getView().byId("SC_HdrTbr").setVisible(false);this.getView().byId("TC_HozLayout1").setVisible(true);this.getView().byId("TC_HozLayout2").setVisible(true);this.getView().byId("SC_HozLayout1").setVisible(false);this.getView().byId("SC_HozLayout2").setVisible(false);this.getView().byId("TC_Toolbar1").setVisible(true);this.getView().byId("SC_Toolbar1").setVisible(false)}else if(e==="S"){this.getView().byId("SportsCardIdPanel").setVisible(true);this.getView().byId("tradingCardIdPanel").setVisible(false);this.getView().byId("TC_HdrTbr").setVisible(false);this.getView().byId("SC_HdrTbr").setVisible(true);this.getView().byId("TC_HozLayout1").setVisible(false);this.getView().byId("TC_HozLayout2").setVisible(false);this.getView().byId("SC_HozLayout1").setVisible(true);this.getView().byId("SC_HozLayout2").setVisible(true);this.getView().byId("TC_Toolbar1").setVisible(false);this.getView().byId("SC_Toolbar1").setVisible(true)}},onFetchDetailsTSViewDetails:function(e,t){this.ViewType=e;if(e==="T"){this.setScreen(e);if(this.DisplayScreenFlag==="X"){this.TC_MainScreenData();this.SC_MainScreenData()}else{if(this.ButtonType=="N"){this.onGetGradeHistcall();this.onMissedCall()}else if(this.ButtonType=="P"){this.onGetGradeHistcallp();this.onMissedCall()}this.SetTCHeaderData(t)}}else if(e==="S"){this.setScreen(e);if(this.DisplayScreenFlag==="X"){this.SC_MainScreenData();this.TC_MainScreenData()}else{if(this.ButtonType=="P"){this.onGetMaraDatacallp();this.SC_onMissedCall()}else if(this.ButtonType=="N"){this.onGetMaraDatacall();this.SC_onMissedCall()}}}else{a.show("Please select valid sales order number")}this.getLabelLine(this.SalesId,t,e)},setAutoGraphValidation(e){this.autoGradeFlag=e;if(e=="X")this.getView().byId("idAutoGrade").setEnabled(true);else this.getView().byId("idAutoGrade").setEnabled(false)},SetTCHeaderData:function(e){var t=this;var i=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,e)];this.oModel.read("/TradingCardSet",{filters:i,success:function(e,i){if(e.results.length!==0){t.ErrorDropdown(e);t.setAutoGraphValidation(e.results[0].RemarksFlag);t.getImage(e.results[0].Certificateno);t.GradeChek=e.results[0].gradedec;t.setCarError(e.results[0])}}})},setCarError:function(e){if(e){if(e.CardErrorFlag=="X"){this.getView().byId("CardErrorFlag").setSelectedIndex(0)}else{this.getView().byId("CardErrorFlag").setSelectedIndex(1);this.getView().byId("idError1").setEnabled(false);this.getView().byId("errorLblTxt").setEnabled(false)}}},getImage:function(e){var t;this.oLineID=this.getView().byId("idLineItem").getValue();if(this.LineId.length=="1"){t=this.oSalesID+"00"+this.oLineID}else if(this.LineId.length=="2"){t=this.oSalesID+"0"+this.oLineID}else{t=this.oSalesID+this.oLineID}var i=[new sap.ui.model.Filter("CertType",sap.ui.model.FilterOperator.EQ,"CARDS"),new sap.ui.model.Filter("CertId",sap.ui.model.FilterOperator.EQ,t)];var s=this;this.oModel_SC.read("/Image_displaySet",{filters:i,success:function(e,t){if(e.results.length!==0){if(e.results[0].FrontUrl!=="proxy not triggered"&&e.results[0].FrontUrl!==" "){this.getView().byId("idFrontUrl").setSrc(e.results[0].FrontUrl);this.getView().byId("idBackUrl").setSrc(e.results[0].BackUrl)}else{s.getView().byId("idFrontUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png");s.getView().byId("idBackUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png")}}else{s.getView().byId("idFrontUrl").setSrc("");s.getView().byId("idBackUrl").setSrc("")}}.bind(this),error:function(){}})},TC_models:function(){var e=new sap.ui.model.json.JSONModel;this.getView().setModel(e,"MainModel");var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"GradHistModel");var e=new sap.ui.model.json.JSONModel;this.getView().setModel(e,"MainModel");var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"GradHistModel")},TC_MainScreenData:function(){this.SalesId=this.getView().byId("idSalesOrder").getValue();var e=this.getView().byId("idSalesOrder").getValue();var t=this.getView().byId("idLineItem").getValue();this.SalesId=this.getView().byId("idSalesOrder").getValue();this.LineId=this.getView().byId("idLineItem").getValue();var i=this.getOwnerComponent().getModel("SC");var s=new sap.ui.model.json.JSONModel;this.TC_models();var r=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,e),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,t)];i.read("/TradingCardSet",{filters:r,success:function(e,t){s.setData(e);if(e.results.length!==0){this.setAutoGraphValidation(e.results[0].RemarksFlag);this.GradeChek=e.results[0].gradedec;this.getImage(e.results[0].Certificateno);if(e.results[0].Perfect10==="X"){this.getView().byId("idGrade").setSelectedKey("PERFECT");this.perfectchk="S"}else if(e.results[0].CardError==="X"){this.getView().byId("idGrade").setSelectedKey("PRISTINE")}else{}if(e.results[0].GradeComplete==="X"){this.getView().byId("idFinish").setSelected(true);this.getView().byId("idExit").setEnabled(false);this.getView().byId("idPrevious").setEnabled(false);this.getView().byId("idNext").setEnabled(false);this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false);this.getView().byId("idNoGrade").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done")}else{this.getView().byId("idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("idPrevious").setEnabled(true);this.getView().byId("idNext").setEnabled(true);this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true);this.getView().byId("idNoGrade").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false)}if(e.results[0].Nograde===""){this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true)}this.setCarError(e.results[0])}else{this.getView().byId("idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("idPrevious").setEnabled(true);this.getView().byId("idNext").setEnabled(true);this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true);this.getView().byId("idNoGrade").setEnabled(true)}this.ErrorDropdown(e)}.bind(this),error:function(){a.show("Failed to Load Screen Information, Please Contact Technical Team")}});var d=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"M")];i.read("/getInitialLineItemsSet",{filters:d,success:function(e,t){s.setData(e);if(e.results.length!==0){var i=e.results[0].ExCount;var a=e.results.length;var r="Missed Gradings";var d=r.concat("(",i,"/",a,")");this.getView().byId("idMsdGradTab").setText(d);e.results.sort(function(e,t){return e.Posnr-t.Posnr})}this.getView().getModel("InitModel").setData(e.results);this.getView().getModel("InitModel").refresh()}.bind(this),error:function(){this.getView().byId("idMsdGradTab").setText("Missed Grading")}});var l=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,e),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,t)];i.read("/Grade_gradehistorySet",{filters:l,success:function(e,t){if(e.results.length!==0){s.setData(e);this.getView().getModel("GradHistModel").setData(e.results);this.getView().getModel("GradHistModel").refresh();this.setSaveNxtPreDisabled(e.results[0])}}.bind(this),error:function(){}})},setSaveNxtPreDisabled:function(e){if(this.ViewType=="T"){if(e.GradeComplete=="X"){this.getView().byId("idPrevious").setEnabled(false);this.getView().byId("idNext").setEnabled(false);this.getView().byId("idGrade").setEnabled(false)}else{this.getView().byId("idPrevious").setEnabled(true);this.getView().byId("idNext").setEnabled(true)}}else if(this.ViewType=="S"){if(e.GradeComplete=="X"){this.getView().byId("SC_idPrevious").setEnabled(false);this.getView().byId("SC_idNext").setEnabled(false);this.getView().byId("SC_idGrade").setEnabled(false)}else{this.getView().byId("SC_idPrevious").setEnabled(true);this.getView().byId("SC_idNext").setEnabled(true)}}},TC_onPristineSelect:function(){if(this.getView().byId("idPristineChk").getSelected()==true){this.getView().byId("idGrade").setValue("Pristine 10");this.getView().byId("idGrade").setSelectedKey("PRISTINE");this.getView().byId("idPerChk").setSelected(false)}else{this.getView().byId("idGrade").setValue("");this.getView().byId("idGrade").setSelectedKey("")}},onPerSelect:function(e){if(this.getView().byId("idPerChk").getSelected()==true){var t=new sap.ui.model.json.JSONModel;t={kgrade:this.getView().byId("idGrade").getSelectedText(),kcenter:this.getView().byId("idCenter").getSelectedKey(),kcorner:this.getView().byId("idCorner").getSelectedKey(),kedge:this.getView().byId("idEdge").getSelectedKey(),ksurface:this.getView().byId("idSurface").getSelectedKey(),lgrade:this.getView().byId("idGrade").getValue(),lcenter:this.getView().byId("idCenter").getValue(),lcorner:this.getView().byId("idCorner").getValue(),ledge:this.getView().byId("idEdge").getValue(),lsurface:this.getView().byId("idSurface").getValue()};this.getView().setModel(t,"DataModel");this.getView().byId("idPristineChk").setSelected(false);this.getView().byId("idCenter").setValue("Gem Mint 10");this.getView().byId("idCorner").setValue("Gem Mint 10");this.getView().byId("idEdge").setValue("Gem Mint 10");this.getView().byId("idSurface").setValue("Gem Mint 10");this.getView().byId("idGrade").setValue("PERFECT");this.getView().byId("idCenter").setSelectedKey("10");this.getView().byId("idCorner").setSelectedKey("10");this.getView().byId("idEdge").setSelectedKey("10");this.getView().byId("idSurface").setSelectedKey("10");this.getView().byId("idGrade").setSelectedKey("PERFECT")}if(this.getView().byId("idPerChk").getSelected()===false){if(this.perfectchk!=="S"){var i=this.getView().getModel("DataModel").lgrade;var s=this.getView().getModel("DataModel").lcenter;var a=this.getView().getModel("DataModel").lcorner;var r=this.getView().getModel("DataModel").ledge;var d=this.getView().getModel("DataModel").lsurface;var l=this.getView().getModel("DataModel").kgrade;var o=this.getView().getModel("DataModel").kcenter;var n=this.getView().getModel("DataModel").kcorner;var g=this.getView().getModel("DataModel").kedge;var u=this.getView().getModel("DataModel").ksurface}this.perfectchk=" ";this.getView().byId("idCenter").setValue(s);this.getView().byId("idCorner").setValue(a);this.getView().byId("idEdge").setValue(r);this.getView().byId("idSurface").setValue(d);this.getView().byId("idGrade").setValue(i);this.getView().byId("idCenter").setSelectedKey(o);this.getView().byId("idCorner").setSelectedKey(n);this.getView().byId("idEdge").setSelectedKey(g);this.getView().byId("idSurface").setSelectedKey(u);this.getView().byId("idGrade").setSelectedKey(l)}},onNoGradeChange:function(e){var t=this.getView().byId("idNoGrade").getSelectedKey();if(t!==""){this.getView().byId("idCenter").setValue();this.getView().byId("idCorner").setValue();this.getView().byId("idEdge").setValue();this.getView().byId("idSurface").setValue();this.getView().byId("idGrade").setValue();this.getView().byId("idAutoGrade").setValue();this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idAutoGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false);this.GradeChek=" "}if(t===""){this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idAutoGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true)}},onGraderInfoClik:function(e){var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"GraderInfoModel");var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId)];s.read("/getGraderInfoSet",{filters:a,success:function(e,t){i.setData(e);if(e.results.length!==0){this.giCount=e.results[0].ExCount}this.getView().getModel("GraderInfoModel").setData(e.results);this.getView().getModel("GraderInfoModel").refresh()}.bind(this),error:function(){}});var r=this,l=this.getView();if(!r.gDialog_TC){r.gDialog_TC=d.load({id:l.getId(),name:"ccgtradingcards.view.fragment.GraderInfo",controller:r}).then(function(e){l.addDependent(e);return e}.bind(r))}r.gDialog_TC.then(function(e){e.open()})},OnGraderClose:function(e){this.byId("GradDialog").close()},onNext:function(e){var t;var i;var s;var d;var l;var o;var n;var g;this.DisplayScreenFlag="";this.ButtonType="N";var u=this.getView().getModel("pInitModel").getData();this.LineId=this.getView().byId("idLineItem").getValue();this.SalesOrderNumber=this.getView().byId("idSalesOrder").getValue();t=this.getView().byId("idGrade").getValue();var h=this.getView().getModel("MainModel").getData();var C=" ";if(this.autoGradeFlag=="X"&&t&&h.ZVcAutograph==""){r.error("Autograph Grade is Mandatory ")}else{if(this.getView().byId("idFinish").getSelected()===true){C="X"}if(this.getView().byId("idFinish").getSelected()!==true){for(var S=0;S<u.length;S++){if(S==u.length-1){var c=u[S];if(this.LineId==c.Posnr){C="X"}}}}if(this.getView().byId("idFinish").getSelected()==true){var V="X"}else{V="Y"}this.GradeChek=this.getView().byId("idGrade").getSelectedKey();o=this.getView().byId("idNoGrade").getSelectedKey();if(o){t="";i="";s="";d="";l="";n="";g="";this.GradeChek=""}else{if(this.GradeChek=="PRISTINE"||this.GradeChek=="PERFECT"){if(this.GradeChek=="PERFECT"){t="10";i="10";s="10";d="10";l="10";n="X"}else if(this.GradeChek=="PRISTINE"){t="10";g="X";n=""}}}var b=this.getView().byId("idNoGrade").getSelectedKey();if(b!==""){t="";i="";s="";d="";l="";n="";g=""}var w=this.getView().byId("idSalesOrder").getValue();var I=this.getView().byId("idLineItem").getValue();if(this.getView().byId("idFinish").getSelected()===true){var V="X"}else{V="Y"}var p={};if(this.getView().byId("CardErrorFlag").getSelectedIndex()==0){this.getCardErrorFlag="X";if(this.CardCode){p.cardErrorCode=this.CardCode;p.cardErrorName=this.cardName;p.errorLblText=this.getView().byId("errorLblTxt").getValue()}else{if(this.getView().byId("idError1").getLastValue()!==""){p.cardErrorCode=this.getView().byId("idError1").getSelectedItem().mProperties.additionalText;p.errorLblText=this.getView().byId("errorLblTxt").getValue();p.cardErrorName=this.getView().byId("idError1").getSelectedItem().mProperties.text}}}else{this.getCardErrorFlag="";p.cardErrorCode="";p.errorLblText="";p.cardErrorName=""}p.flag=this.getCardErrorFlag;this.onCardDrpDwnCLear();var f=[];var y={KeyComment1:h.KeyComment1,CollectorNum:" ",Vbeln:w,KeyComment2:h.KeyComment2,CardErrorFlag:p.flag,Posnr:I,KeyComment3:h.KeyComment3,Matnr:h.Matnr,CardInfoCmt:h.CardInfoCmt,GameCode:" ",LangCode:" ",SetCode:" ",CardName:p.cardErrorName,CardLabeltext:p.errorLblText,VariantCode1:" ",VariantCode2:" ",RarityCode:" ",Pedigree:h.Pedigree,GreekPrefix:" ",GreekSuffix:" ",StarSymbol:" ",GenderSymbol:" ",InternalNote:h.InternalNote,CardError:p.cardErrorCode,CardDefect:h.CardDefect,FinalGrade:V,Center:i,Surface:l,Corner:s,Edge:d,Nograde:o,Aicenter:"",Aicorner:"",Aiedge:"",Aisurface:"",Grade:t,Perfect10:n,ExtRefItemId:g,Bump:h.Bump,ZVcAutograph:h.ZVcAutograph};if(y.CardLabeltext==" "){y.CardLabeltext=p.errorLblText}f.push(y);var m=this;var M=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZODATA_CHARACTERISTCS_GRADENEW_SRV/");M.create("/TradingCardSet",y,{method:"POST",success:function(e){if(e.Imflag=="E"){r.error("Collectable ID is In-active")}else{var t=e.MESSAGE;a.show("Data Saved Succesfully");m.getNextLineItem("N").then(function(e){m.onFetchDetailsValidate(e)},true)}},error:function(e){}})}},onGetGradeHistcall:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"N")];i.read("/Grade_gradehistorySet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){if(e.results[0].Perfect10==="X"){this.perfectchk="S"}else{}if(e.results[0].GradeComplete==="X"){this.getView().byId("idFinish").setSelected(true);this.getView().byId("idExit").setEnabled(false);this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false);this.getView().byId("idNoGrade").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done");this.SetLineItem(e.results[0].Posnr)}else{this.getView().byId("idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true);this.getView().byId("idNoGrade").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false)}else{this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true)}this.setSaveNxtPreDisabled(e.results[0])}this.getView().getModel("GradHistModel").setData(e.results);this.getView().getModel("GradHistModel").refresh()}.bind(this),error:function(){}})},onMissedCall:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"M")];i.read("/getInitialLineItemsSet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){var s=e.results[0].ExCount;var a=e.results.length;var r="Missed Gradings";var d=r.concat("(",s,"/",a,")");this.getView().byId("idMsdGradTab").setText(d);e.results.sort(function(e,t){return e.Posnr-t.Posnr})}this.getView().getModel("InitModel").setData(e.results);this.getView().getModel("InitModel").refresh()}.bind(this),error:function(){this.getView().byId("idMsdGradTab").setText("Missed Grading")}})},onCardDrpDwnCLear:function(){this.getView().byId("idError1").setSelectedKey("");this.getView().byId("errorLblTxt").setValue("")},onCardErrorFlag:function(e){this.getCardErrorFlag=e.getSource().getSelectedButton().mProperties.text;if(this.getCardErrorFlag=="No"){this.getView().byId("idError1").setEnabled(false);this.getView().byId("idError1").setSelectedKey("");this.getView().byId("errorLblTxt").setEnabled(false);this.getView().byId("errorLblTxt").setValue("")}else{this.getView().byId("idError1").setEnabled(true);this.getView().byId("errorLblTxt").setEnabled(true)}},onErrorSelected:function(e){this.cardName=e.getSource().getSelectedItem().mProperties.text;this.CardCode=e.getSource().getSelectedItem().mProperties.additionalText;this.errorLblTxt=e.getSource().getSelectedItem().mProperties.key;this.getView().getModel("MainModel").getData().CardLabeltext=this.errorLblTxt;this.getView().getModel("MainModel").refresh()},onPrevious:function(e){var t;var i;var s;var d;var l;var o;var n;var g;var u=this.getView().getModel("MainModel").getData();this.DisplayScreenFlag="";this.ButtonType="P";this.LineId=this.getView().byId("idLineItem").getValue();this.SalesOrderNumber=this.getView().byId("idSalesOrder").getValue();t=this.getView().byId("idGrade").getValue();var h=this.getView().getModel("pInitModel").getData();var C=" ";if(this.LineId==h[0].Posnr){C="X"}if(this.autoGradeFlag=="X"&&t&&u.ZVcAutograph==""){r.error("Autograph Grade is Mandatory ")}else{if(this.getView().byId("idFinish").getSelected()==true){var S="X"}else{S="Y"}this.GradeChek=this.getView().byId("idGrade").getSelectedKey();o=this.getView().byId("idNoGrade").getSelectedKey();if(o){t="";i="";s="";d="";l="";n="";g="";this.GradeChek=""}else{if(this.GradeChek=="PRISTINE"||this.GradeChek=="PERFECT"){if(this.GradeChek=="PERFECT"){t="10";i="10";s="10";d="10";l="10";n="X"}else if(this.GradeChek=="PRISTINE"){t="10";g="X";n=""}}}var c=this.getView().byId("idNoGrade").getSelectedKey();if(c!==""){t="";i="";s="";d="";l="";n="";g=""}var V=this.getView().byId("idSalesOrder").getValue();var b=this.getView().byId("idLineItem").getValue();if(this.getView().byId("idFinish").getSelected()===true){var S="X"}else{S="Y"}var w={};if(this.getView().byId("CardErrorFlag").getSelectedIndex()==0){this.getCardErrorFlag="X";if(this.CardCode){w.cardErrorCode=this.CardCode;w.cardErrorName=this.cardName;w.errorLblText=this.getView().byId("errorLblTxt").getValue()}else{if(this.getView().byId("idError1").getLastValue()!==""){w.cardErrorCode=this.getView().byId("idError1").getSelectedItem().mProperties.additionalText;w.errorLblText=this.getView().byId("errorLblTxt").getValue();w.cardErrorName=this.getView().byId("idError1").getSelectedItem().mProperties.text}}}else{this.getCardErrorFlag="";w.cardErrorCode="";w.errorLblText="";w.cardErrorName=""}this.onCardDrpDwnCLear();var I=[];var p={KeyComment1:" ",CollectorNum:" ",Vbeln:V,KeyComment2:" ",CardErrorFlag:this.getCardErrorFlag,Posnr:b,KeyComment3:" ",Matnr:u.Matnr,CardInfoCmt:u.CardInfoCmt,GameCode:" ",LangCode:" ",SetCode:" ",CardName:w.cardErrorName,CardLabeltext:w.errorLblText,CardLabeltext:" ",VariantCode1:" ",VariantCode2:" ",RarityCode:" ",Pedigree:u.Pedigree,GreekPrefix:" ",GreekSuffix:" ",StarSymbol:" ",GenderSymbol:" ",InternalNote:u.InternalNote,CardError:w.cardErrorCode,CardDefect:u.CardDefect,FinalGrade:S,Center:i,Surface:l,Corner:s,Edge:d,Nograde:o,Aicenter:"",Aicorner:"",Aiedge:"",Aisurface:"",Grade:t,Perfect10:n,ExtRefItemId:g,Bump:u.Bump,ZVcAutograph:u.ZVcAutograph};if(p.CardLabeltext==" "){p.CardLabeltext=w.errorLblText}I.push(p);var f=this;var y=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZODATA_CHARACTERISTCS_GRADENEW_SRV/");y.create("/TradingCardSet",p,{method:"POST",success:function(e){if(e.Imflag=="E"){r.error("Collectable ID is In-active")}else{var t=e.MESSAGE;a.show("Data Saved Succesfully");f.getNextLineItem("P").then(function(e){f.onFetchDetailsValidate(e)},true)}},error:function(e){}})}},getNextLineItem:function(e){return new Promise(function(t,i){var s=this;this.oDataMaradata=[];this.SalesOrderNumber=this.getView().byId("idSalesOrder").getValue();var a=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesOrderNumber),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,e)];this.oModel.read("/Grade_MARADATASet",{filters:a,success:function(i,a){if(i.results[0].LvPosnr!==s.LineId){t(i.results[0].ExtRefItemId)}else{if(s.GradeCompleted_SC==" "&&s.GradeCompleted==" "){if(e=="N")r.information("No further Lineitems to Grade");else if(e=="P")r.information("No Previous Lineitems to Grade")}t(s.LineId)}s.oDataMaradata=i.results},error(e){t()}})}.bind(this))},onGetGradeHistcallp:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"P")];i.read("/Grade_gradehistorySet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){if(e.results[0].Perfect10==="X"){this.perfectchk="S"}else{}if(e.results[0].GradeComplete==="X"){this.getView().byId("idFinish").setSelected(true);this.getView().byId("idExit").setEnabled(false);this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false);this.getView().byId("idNoGrade").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done");this.SetLineItem(e.results[0].Posnr)}else{this.getView().byId("idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true);this.getView().byId("idNoGrade").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("idGrade").setEnabled(false);this.getView().byId("idCenter").setEnabled(false);this.getView().byId("idCorner").setEnabled(false);this.getView().byId("idEdge").setEnabled(false);this.getView().byId("idSurface").setEnabled(false)}else{this.getView().byId("idGrade").setEnabled(true);this.getView().byId("idCenter").setEnabled(true);this.getView().byId("idCorner").setEnabled(true);this.getView().byId("idEdge").setEnabled(true);this.getView().byId("idSurface").setEnabled(true)}this.setSaveNxtPreDisabled(e.results[0])}this.getView().getModel("GradHistModel").setData(e.results);this.getView().getModel("GradHistModel").refresh()}.bind(this),error:function(){}})},onCancel:function(e){var t=sap.ushell.Container.getService("CrossApplicationNavigation");t.toExternal({target:{semanticObject:"#"}})},onExitCust:function(e){var t=this;this.getView().byId("idFinish").setSelected(false);this.getView().byId("idCrossOver").setValue(" ");var i=sap.ushell.Container.getService("CrossApplicationNavigation");i.toExternal({target:{semanticObject:"#"}})},OnUserClose:function(e){this.byId("UserDialog").close()},onGradCompleteSelect:function(e){var t=this;if(this.getView().byId("idFinish").getSelected()===false){r.warning("You are Revoking the Grade Completion status, Click OK & Save to continue",{actions:[r.Action.OK,r.Action.CANCEL],emphasizedAction:r.Action.OK,onClose:function(e){if(e==="OK"){var i=new sap.ui.model.json.JSONModel;var s=t.getOwnerComponent().getModel();var a=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,t.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,t.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"D")];s.read("/getInitialLineItemsSet",{filters:a,success:function(e,s){i.setData(e);t.GradeCompleted=" ";t.getView().byId("idFinish").setEnabled(true);t.getView().byId("idExit").setEnabled(true);t.getView().byId("idPrevious").setEnabled(true);t.getView().byId("idNext").setEnabled(true);t.getView().byId("idGrade").setEnabled(true);t.getView().byId("idCenter").setEnabled(true);t.getView().byId("idCorner").setEnabled(true);t.getView().byId("idEdge").setEnabled(true);t.getView().byId("idSurface").setEnabled(true);t.getView().byId("idNoGrade").setEnabled(true)}.bind(this),error:function(){}})}}})}if(this.getView().byId("idFinish").getSelected()===true){this.LineId=this.getView().byId("idGradLine").getText();var i=this.getView().byId("idGrade").getSelectedKey();var s=this.getView().byId("idNoGrade").getSelectedKey();var a=new sap.ui.model.json.JSONModel;var d=this.getOwnerComponent().getModel("SC");var l=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"G")];d.read("/getInitialLineItemsSet",{filters:l,success:function(e,d){a.setData(e);if(e.results.length!==0){if(e.results[0].Posnr!==""&&i===""||e.results[0].Posnr!==""&&s===""){var l="There are ungraded items on this order against the item no ";var o=this.LineId;var n=l.concat(o);this.getView().byId("idFinish").setSelected(false);r.error(n)}}else{var g;var u=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId)];r.confirm("Do you want to complete the Grading for this order?, click OK & Save to confirm",{actions:[r.Action.OK,r.Action.CANCEL],emphasizedAction:r.Action.OK,onClose:function(e){if(e==="OK"){t.GradeCompleted="X";t.getView().byId("idPrevious").setEnabled(false);t.getView().byId("idNext").setEnabled(false);t.getView().byId("idGrade").setEnabled(false);t.onNext()}if(e==="CANCEL"){t.getView().byId("idFinish").setSelected(false)}}})}}.bind(this),error:function(){}})}},onDispStatus:function(e){var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"userStatusModel");var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId)];s.read("/UserStatusSet",{filters:a,success:function(e,t){i.setData(e);this.getView().getModel("userStatusModel").setData(e.results);this.getView().getModel("userStatusModel").refresh()}.bind(this),error:function(){}});var r=this,l=this.getView();if(!r.uDialog){r.uDialog=d.load({id:l.getId(),name:"ccgtradingcards.view.fragment.Userstatus",controller:r}).then(function(e){l.addDependent(e);return e}.bind(r))}r.uDialog.then(function(e){e.open()})},onSignaturePress:function(){var e=this,t=this.getView();if(!e.oSignatureDialog){e.oSignatureDialog=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.Signature",controller:e}).then(function(e){e.setModel();t.addDependent(e);return e}.bind(e))}e.oSignatureDialog.then(function(e){e.open()})},onExitPress:function(){this.oSignatureDialog.then(function(e){e.close()})},onFetchDetails:function(e){var t=this;t.GradeCompleted_SC=" ";t.GradeCompleted=" ";this.DisplayScreenFlag="X";this.oSalesID=this.getView().byId("idSalesOrder").getValue();this.oLineID=this.getView().byId("idLineItem").getValue();if(this.oLineID===""){r.error("Please select Lineitem")}if(this.oLineID!==""){var i=new sap.ui.model.json.JSONModel;var s=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.oSalesID),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.oLineID),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"L")];var a=" ";this.oModel_SC.read("/Grade_MARADATASet",{filters:s,success:function(e,s){i.setData(e);if(e.results.length!==0){if(e.results[0].Exflag==="X"){r.error("Verification not yet completed")}else{if(e.results[0].Lifsk==="50"){a="X";r.error("Delivery Block active for Payment")}else{if(e.results[0].Zterm!=="0001"&&(e.results[0].Cmgst==="B"||e.results[0].Cmgst==="C")){a="X";r.error("Order have credit limit exceeded,please remove credit block ")}else{if(e.results[0].Lifsk==="60"){a="X";r.error("Delivery Block active")}else{if(a!=="X"){t.onFetchDetailsValidate(this.oLineID);t.getBumpData(this.oLineID)}}}}}}this.getView().getModel("initMaraData").setData(e.results[0]);this.getView().getModel("initMaraData").refresh()}.bind(this),error:function(){}})}},getBumpData:function(e){var t=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,e)];this.oModel_SC.read("/Grade_bumpSet",{filters:t,success:function(e,t){e.results.unshift(" ");this.getView().getModel("SC_BumpModel").setData(e.results);this.getView().getModel("SC_BumpModel").refresh()}.bind(this),error:function(){}})},SC_Models:function(){var e={selected:""};var t=new sap.ui.model.json.JSONModel(e);this.getView().setModel(t,"oGradselModel");var i=new sap.ui.model.json.JSONModel;this.getView().setModel(i,"SC_MaraDataModel");var s=new sap.ui.model.json.JSONModel;this.getView().setModel(s,"SC_GradHistModel");var a=new sap.ui.model.json.JSONModel;this.getView().setModel(a,"SC_CollectibleModel");var r=new sap.ui.model.json.JSONModel;this.getView().setModel(r,"SC_InitModel");var d=new sap.ui.model.json.JSONModel;this.getView().setModel(d,"SC_YearModel");var l=new sap.ui.model.json.JSONModel;this.getView().setModel(l,"SC_ImageModel");var o=new sap.ui.model.json.JSONModel;this.getView().setModel(o,"SC_pInitModel");var n=new sap.ui.model.json.JSONModel;this.getView().setModel(n,"SC_SportsCardModel");var g=new sap.ui.model.json.JSONModel;this.getView().setModel(g,"SC_CornerModel");var u=new sap.ui.model.json.JSONModel;this.getView().setModel(u,"SC_CenterModel");var h=new sap.ui.model.json.JSONModel;this.getView().setModel(h,"SC_AutoGradeModel");var C=new sap.ui.model.json.JSONModel;this.getView().setModel(C,"SC_BumpModel");var S=new sap.ui.model.json.JSONModel;this.getView().setModel(S,"SC_EdgeModel");var c=new sap.ui.model.json.JSONModel;this.getView().setModel(c,"SC_GradeModel");var V=new sap.ui.model.json.JSONModel;this.getView().setModel(V,"SC_NoGradeModel");var b=new sap.ui.model.json.JSONModel;this.getView().setModel(b,"SC_SurfaceModel");var w=new sap.ui.model.json.JSONModel;this.getView().setModel(w,"SC_SetCodeModel");w.setSizeLimit(600);var I=new sap.ui.model.json.JSONModel;this.getView().setModel(I,"SC_SubsetModel");I.setSizeLimit(1e3);var p=new sap.ui.model.json.JSONModel;this.getView().setModel(p,"SC_MakerModel");p.setSizeLimit(1e3)},SC_MainScreenData:function(e){this.getView().byId("SC_idMsdGradTab").setText("Missed Grading");this.getView().byId("SC_idSportsCard").setValue(" ");this.getView().byId("SC_idInputManuf").setValue(" ");this.getView().byId("SC_idSetCode").setValue(" ");this.getView().byId("SC_idPlayer").setValue(" ");this.getView().byId("SC_idSubset").setValue(" ");this.getView().byId("SC_idInputCardNo").setValue(" ");this.getView().byId("SC_idInputNota").setValue(" ");this.getView().byId("SC_idInputPedig").setValue(" ");this.getView().byId("SC_idInputCollId").setValue(" ");this.getView().byId("SC_idBump").setSelectedKey("");this.getView().byId("SC_idInputYear").setValue(" ");this.getView().byId("SC_idInputAttr1").setValue(" ");this.getView().byId("SC_idInputAttr2").setValue(" ");this.getView().byId("SC_idFinish").setSelected(false);var t=new sap.ui.model.json.JSONModel;this.SalesId=this.oSalesID;this.LineId=this.oLineID;this.getView().byId("SC_idGradSales").setText(this.SalesId);this.SC_Models();var i=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId)];this.oModel_SC.read("/Grade_SportscardSet",{success:function(e,i){t.setData(e);e.results.unshift(" ");this.getView().getModel("SC_SportsCardModel").setData(e.results);this.getView().getModel("SC_SportsCardModel").refresh()}.bind(this),error:function(){a.show("SportsCard Data not loaded, Please Contact Technical Team")}});this.oModel_SC.read("/Grade_autogradeSet",{success:function(e,t){this.setSCGradingValues(e.results)}.bind(this),error:function(){}});this.oModel_SC.read("/Grade_MakerSet",{filters:i,success:function(e,i){t.setData(e);e.results.unshift(" ");this.getView().getModel("SC_MakerModel").setData(e.results);this.getView().getModel("SC_MakerModel").refresh()}.bind(this),error:function(){}});this.oModel_SC.read("/ZmmSubsetsrchSet",{success:function(e,i){t.setData(e);e.results.unshift(" ");this.getView().getModel("SC_SubsetModel").setData(e.results);this.getView().getModel("SC_SubsetModel").refresh()}.bind(this),error:function(){}});this.oModel_SC.read("/Grade_MARADATASet",{filters:i,success:function(e,i){t.setData(e);if(e.results.length!==0){this.Certid=e.results[0].CertificateNo;this.Collid=e.results[0].CollectibleId;if(e.results[0].ZThickHolderFlag==="X"){this.getView().byId("SC_idTH").setSelected(true)}else{this.getView().byId("SC_idTH").setSelected(false)}if(e.results[0].FactoryAutograph==="X"){this.getView().byId("SC_idInputAuto").setSelected(true)}else{this.getView().byId("SC_idInputAuto").setSelected(false)}this.VcScCrossover=" ";this.VcScCrossover=e.results[0].VcScCrossover;if(e.results[0].VcScCrossover===" "){}else{}}this.getView().getModel("SC_MaraDataModel").setData(e.results[0]);this.getView().getModel("SC_MaraDataModel").refresh();this.SC_getImage()}.bind(this),error:function(){a.show("Error in Loading Material Master Data, Please Contact Technical Team")}});this.oModel_SC.read("/Grade_gradehistorySet",{filters:i,success:function(e,i){t.setData(e);if(e.results.length!==0){this.GradeChek_SC=e.results[0].gradedec;if(e.results[0].Perfect10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PERFECT");this.perfectchk="S"}else if(e.results[0].Pristine10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PRISTINE")}if(e.results[0].GradeComplete==="X"){this.getView().byId("SC_idFinish").setSelected(true);this.getView().byId("idExit").setEnabled(false);this.getView().byId("SC_idPrevious").setEnabled(false);this.getView().byId("SC_idNext").setEnabled(false);this.getView().byId("SC_idInputCollId").setEnabled(false);this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false);this.getView().byId("SC_idNoGrade").setEnabled(false);this.getView().byId("SC_idBump").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done")}else{this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("SC_idPrevious").setEnabled(true);this.getView().byId("SC_idNext").setEnabled(true);this.getView().byId("SC_idInputCollId").setEnabled(true);this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true);this.getView().byId("SC_idBump").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false)}if(e.results[0].Nograde===""){this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true)}this.setSaveNxtPreDisabled(e.results[0])}else{this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("idExit").setEnabled(true);this.getView().byId("SC_idPrevious").setEnabled(true);this.getView().byId("SC_idNext").setEnabled(true);this.getView().byId("SC_idInputCollId").setEnabled(true);this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true);this.getView().byId("SC_idBump").setEnabled(true)}this.getView().getModel("SC_GradHistModel").setData(e.results);this.getView().getModel("SC_GradHistModel").refresh()}.bind(this),error:function(){a.show("Error in Loading Grading History Data, Please Contact Technical Team")}});this.oModel_SC.read("/getYearDropdownSet",{success:function(e,i){t.setData(e);this.getView().getModel("SC_YearModel").setData(e.results);this.getView().getModel("SC_YearModel").refresh()}.bind(this),error:function(){}});var s=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"M")];this.oModel_SC.read("/getInitialLineItemsSet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){var s=e.results[0].ExCount;var a=e.results.length;var r="Missed Gradings";var d=r.concat("(",s,"/",a,")");this.getView().byId("SC_idMsdGradTab").setText(d);e.results.sort(function(e,t){return e.Posnr-t.Posnr})}this.getView().getModel("SC_InitModel").setData(e.results);this.getView().getModel("SC_InitModel").refresh()}.bind(this),error:function(){}});var r=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"P")];this.oModel_SC.read("/getInitialLineItemsSet",{filters:r,success:function(e,i){t.setData(e);this.getView().getModel("SC_pInitModel").setData(e.results);this.getView().getModel("SC_pInitModel").refresh()}.bind(this),error:function(){}})},SC_getImage:function(){var e;this.oLineID=this.getView().byId("idLineItem").getValue();if(this.LineId.length=="1"){e=this.oSalesID+"00"+this.oLineID}else if(this.LineId.length=="2"){e=this.oSalesID+"0"+this.oLineID}else{e=this.oSalesID+this.oLineID}var t=[new sap.ui.model.Filter("CertType",sap.ui.model.FilterOperator.EQ,"CARDS"),new sap.ui.model.Filter("CertId",sap.ui.model.FilterOperator.EQ,e)];var i=this;this.oModel_SC.read("/Image_displaySet",{filters:t,success:function(e,t){if(e.results.length!==0){if(e.results[0].FrontUrl!=="proxy not triggered"&&e.results[0].FrontUrl!==" "){this.getView().byId("SC_idFrontUrl").setSrc(e.results[0].FrontUrl);this.getView().byId("SC_idBackUrl").setSrc(e.results[0].BackUrl)}else{i.getView().byId("SC_idFrontUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png");i.getView().byId("SC_idBackUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png")}}else{i.getView().byId("SC_idFrontUrl").setSrc("");i.getView().byId("SC_idBackUrl").setSrc("")}}.bind(this),error:function(){i.getView().byId("SC_idFrontUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png");i.getView().byId("SC_idBackUrl").setSrc("/sap/bc/ui5_ui5/sap/ZSD_GRADINGAPP/Image/No_image.png")}})},setSCGradingValues:function(e){var t=[];var i=[];var s=[];e.forEach(function(e){if(e.ImFlag=="C"){s.push(e)}else if(e.ImFlag=="N"){i.push(e)}else if(e.ImFlag=="A"){t.push(e)}});t.sort(function(e,t){return t.CharValue-e.CharValue});this.getView().getModel("SC_CenterModel").setData(s);this.getView().getModel("SC_CenterModel").refresh();this.getView().getModel("SC_AutoGradeModel").setData(t);this.getView().getModel("SC_AutoGradeModel").refresh();this.getView().getModel("SC_NoGradeModel").setData(i);this.getView().getModel("SC_NoGradeModel").refresh();this.getView().getModel("SC_SurfaceModel").setData(s);this.getView().getModel("SC_SurfaceModel").refresh();this.getView().getModel("SC_CornerModel").setData(s);this.getView().getModel("SC_CornerModel").refresh();this.getView().getModel("SC_EdgeModel").setData(s);this.getView().getModel("SC_EdgeModel").refresh()},SC_onExitCust:function(e){var t=this;this.getView().byId("SC_idSportsCard").setValue(" ");this.getView().byId("SC_idInputManuf").setValue(" ");this.getView().byId("SC_idSetCode").setValue(" ");this.getView().byId("SC_idPlayer").setValue(" ");this.getView().byId("SC_idSubset").setValue(" ");this.getView().byId("SC_idInputCardNo").setValue(" ");this.getView().byId("SC_idInputNota").setValue(" ");this.getView().byId("SC_idInputPedig").setValue(" ");this.getView().byId("SC_idInputCollId").setValue(" ");this.getView().byId("SC_idBump").setSelectedKey("");this.getView().byId("SC_idInputYear").setValue(" ");this.getView().byId("SC_idInputAttr1").setValue(" ");this.getView().byId("SC_idInputAttr2").setValue(" ");this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("SC_idCrossOver").setValue(" ");this.getView().getModel("SC_InitModel").refresh();var i=sap.ushell.Container.getService("CrossApplicationNavigation");i.toExternal({target:{semanticObject:"#"}})},SC_onCancel:function(e){this.getView().byId("SC_idSportsCard").setValue(" ");this.getView().byId("SC_idInputManuf").setValue(" ");this.getView().byId("SC_idSetCode").setValue(" ");this.getView().byId("SC_idPlayer").setValue(" ");this.getView().byId("SC_idSubset").setValue(" ");this.getView().byId("SC_idInputCardNo").setValue(" ");this.getView().byId("SC_idInputNota").setValue(" ");this.getView().byId("SC_idInputPedig").setValue(" ");this.getView().byId("SC_idInputCollId").setValue(" ");this.getView().byId("SC_idBump").setSelectedKey("");this.getView().byId("SC_idInputYear").setValue(" ");this.getView().byId("SC_idInputAttr1").setValue(" ");this.getView().byId("SC_idInputAttr2").setValue(" ");this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("SC_idCrossOver").setValue(" ");this.getView().getModel("SC_MaraDataModel").refresh();this.getView().getModel("SC_GradHistModel").refresh();this.getView().getModel("SC_CollectibleModel").refresh();this.getView().getModel("SC_ImageModel").refresh()},SC_onPrintLabel:function(e){var t=this.getView().byId("SC_idInputCollId").getValue();if(t===""){r.error("Collectible ID is missing, cannot Print Preview")}if(t!==""){var i=new sap.m.BusyDialog({text:"Please wait.. PDF Preview is getting Generated"});i.open();var s=this.getView().getModel().sServiceUrl;var a=s+"/FILE_PDFDISPLAYSet(Vbeln='"+this.SalesId+"',Posnr='"+this.oLineID+"',Box='NO')/$value";i.close();window.open(a)}},onPrintLabel:function(){var e=this.getView().byId("idMatnr").getValue();if(e===""){r.error("Collectible ID is missing, cannot Print Preview")}if(e!==""){var t=new sap.m.BusyDialog({text:"Please wait.. PDF Preview is getting Generated"});t.open();var i=this.getView().getModel().sServiceUrl;var s=i+"/FILE_PDFDISPLAYSet(Vbeln='"+this.SalesId+"',Posnr='"+this.oLineID+"',Box='NO')/$value";t.close();window.open(s)}},onCloseDialogn:function(){this.byId("imgDialog").close();if(this._pDialog){var e=this._pDialog;e.close()}},SC_onNext:function(e){this.DisplayScreenFlag="";this.LineId=this.getView().byId("idLineItem").getValue();this.SalesOrderNumber=this.getView().byId("idSalesOrder").getValue();var t=this;var i=this.getView().byId("SC_idAutoGrade").getSelectedKey();var s=this.getView().byId("SC_idNoGrade").getSelectedKey();if(this.getView().byId("SC_idInputAuto").getSelected()===true&&s===""){if(i===""){r.error("Autograph Grade is Mandatory")}else{t.onSave()}}else{t.onSave()}},SC_onPrevious:function(e){var t=this;this.DisplayScreenFlag="";var i=this.getView().byId("SC_idAutoGrade").getSelectedKey();var s=this.getView().byId("SC_idNoGrade").getSelectedKey();this.LineId=this.getView().byId("idLineItem").getValue();this.SalesOrderNumber=this.getView().byId("idSalesOrder").getValue();if(this.getView().byId("SC_idInputAuto").getSelected()===true&&s===" "){if(i===""){r.error("Autograph Grade is Mandatory")}else{t.onSavep()}}else{t.onSavep()}},onSave:function(e){var t;var i;var s;var d;var l;var o;var n;var g;var u;this.ButtonType="N";var h=this.getView().getModel("SC_MaraDataModel").getData();this.GradeChek_SC=this.getView().byId("SC_idGrade").getSelectedKey();t=this.getView().byId("SC_idGrade").getValue();if(this.GradeChek_SC=="PRISTINE"||this.GradeChek_SC=="PERFECT"){if(this.GradeChek_SC=="PERFECT"){t="10";i="10";s="10";d="10";l="10";g="X"}else if(this.GradeChek_SC=="PRISTINE"){t="10";i="";s="";d="";l="";g="";u="X"}o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}else{g=" ";i=" ";s=" ";d=" ";l=" ";o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}var C=this.getView().byId("SC_idNoGrade").getSelectedKey();if(C!==""){t="";i="";s="";d="";l="";g="";o=""}var S=this.getView().byId("SC_idBump").getSelectedKey();var c=[];var V={ImFlag:"S",Centering:i,ZThickHolderFlag:" ",Perfect10:g,LvPosnr:h.LvPosnr,Corner:s,LvVbeln:h.LvVbeln,Edge:d,ExPosnr:h.LvPosnr,Surface:l,ExVbeln:h.LvVbeln,AutoGrade:o,Matnr:"",Grade:t,ZCardYear:h.ZCardYear,NoGrade:n,ZCsgSportsCode:h.ZCsgSportsCode,ZCsgMakerCode:h.ZCsgMakerCode,ZCsgSetCode:h.ZCsgSetCode,ZCsgSubsetCode:h.ZCsgSubsetCode,ZCsgSportPlayerCode:" ",ZCardNumber:h.ZCardNumber,ZCsgCardAttribute1Code:h.ZCsgCardAttribute1Code,ZCsgCardAttribute2Code:h.ZCsgCardAttribute2Code,ZCsgCardAttrib1Descr:h.ZCsgCardAttrib1Descr,ZCsgCardAttrib2Descr:h.ZCsgCardAttrib2Descr,ZTeamDescription:h.ZTeamDescription,ZDateFreetext:h.ZDateFreetext,Notation:h.Notation,Pedigree:h.Pedigree,FactoryAutograph:h.FactoryAutograph,Bump:S,InternalNote:h.InternalNote,CollectibleId:h.CollectibleId,ZSubjectDescription:h.ZSubjectDescription,CertificateNo:h.CertificateNo,VcScCrossover:h.VcScCrossover,VcScServices:h.VcScServices,VcScAddOn:h.VcScAddOn,VcScCrossoverCo:h.VcScCrossoverCo,VcScCrossoverGr:h.VcScCrossoverGr,VcTradeshow:h.VcTradeshow,ScAiSubgradeCentre:h.ScAiSubgradeCentre,ScAiSubgradeCorner:h.ScAiSubgradeCorner,ScAiSubgradeEdge:h.ScAiSubgradeEdge,ScAiSubgradeSurface:h.ScAiSubgradeSurface,ScAiSubgradeAuto:h.ScAiSubgradeAuto};c.push(V);var b=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZODATA_CHARACTERISTCS_GRADENEW_SRV/");var w=this;b.create("/Grade_MARADATASet",V,{method:"POST",success:function(e){if(e.ImFlag=="E"){r.error("Collectable ID is In-active")}else{w.SaveGradeHistoryData().then(function(t){var i=e.MESSAGE;a.show("Data Saved Succesfully");w.getNextLineItem("N").then(function(e){w.onFetchDetailsValidate(e)},true)})}},error:function(e){a.show("Failed to save Data")}})},SaveGradeHistoryData:function(){return new Promise(function(e,t){var i;var s;var r;var d;var l;var o;var n;var g;var u;var h=this.getView().getModel("SC_MaraDataModel").getData();if(this.getView().byId("SC_idFinish").getSelected()===true){var C="X"}else{C="Y"}this.GradeChek_SC=this.getView().byId("SC_idGrade").getSelectedKey();i=this.getView().byId("SC_idGrade").getValue();if(this.GradeChek_SC=="PRISTINE"||this.GradeChek_SC=="PERFECT"){if(this.GradeChek_SC=="PERFECT"){s="10";r="10";d="10";l="10";i="10";g="X";u=""}else if(this.GradeChek_SC=="PRISTINE"){i="10";u="X";g=""}o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}else{g=" ";u="";s="";r="";d="";l="";o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}var S=this.getView().byId("SC_idNoGrade").getSelectedKey();if(S!==""){i="";s="";r="";d="";l="";g="";u="";o=""}var c=[];var V={ImFlag:"S",Center:s,LvPosnr:h.LvPosnr,Corner:r,BizUnit:" ",LvVbeln:h.LvVbeln,Edge:d,ExPosnr:" ",Surface:l,ExVbeln:" ",Auto:o,SeqNo:1,Action:"Graded",Vbeln:h.LvVbeln,Posnr:h.LvPosnr,CollectibleId:h.CollectibleId,Grade:i,Guser:"",Gdate:"2022-06-27T00:00:00",FinalGrade:C,Nograde:n,Perfect10:g,Pristine10:u,Pedigree:h.Pedigree,InternalNote:h.InternalNote,Notation:h.Notation};c.push(V);var b=this;var w=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZODATA_CHARACTERISTCS_GRADENEW_SRV/");w.create("/Grade_gradehistorySet",V,{method:"POST",success:function(t){a.show("Grading Data Saved Succesfully");e()},error:function(t){e()}})}.bind(this))},onSavep:function(e){var t;var i;var s;var d;var l;var o;var n;var g;var u;this.ButtonType="P";var h=this.getView().getModel("SC_MaraDataModel").getData();if(this.GradeChek_SC=="PERFECT"){t="10";i="10";s="10";d="10";l="10";g="X";o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}else{g=" ";t=this.GradeChek_SC;o=this.getView().byId("SC_idAutoGrade").getSelectedKey();n=this.getView().byId("SC_idNoGrade").getSelectedKey()}var C=this.getView().byId("SC_idNoGrade").getSelectedKey();if(C!==""){t="";i="";s="";d="";l="";g="";o=""}var S=this.getView().byId("SC_idBump").getSelectedKey();var c=[];var V={ImFlag:"S",Centering:i,ZThickHolderFlag:" ",Perfect10:g,LvPosnr:h.LvPosnr,Corner:s,LvVbeln:h.LvVbeln,Edge:d,ExPosnr:h.LvPosnr,Surface:l,ExVbeln:h.LvVbeln,AutoGrade:o,Matnr:"",Grade:t,ZCardYear:h.ZCardYear,NoGrade:n,ZCsgSportsCode:h.ZCsgSportsCode,ZCsgMakerCode:h.ZCsgMakerCode,ZCsgSetCode:h.ZCsgSetCode,ZCsgSubsetCode:" ",ZCsgSportPlayerCode:" ",ZCardNumber:h.ZCardNumber,ZCsgCardAttribute1Code:h.ZCsgCardAttribute1Code,ZCsgCardAttribute2Code:h.ZCsgCardAttribute2Code,ZCsgCardAttrib1Descr:h.ZCsgCardAttrib1Descr,ZCsgCardAttrib2Descr:h.ZCsgCardAttrib2Descr,Notation:h.Notation,Pedigree:h.Pedigree,FactoryAutograph:h.FactoryAutograph,Bump:S,InternalNote:h.InternalNote,CollectibleId:h.CollectibleId,ZSubjectDescription:h.ZSubjectDescription,CertificateNo:h.CertificateNo,VcScCrossover:h.VcScCrossover,VcScServices:h.VcScServices,VcScAddOn:h.VcScAddOn,VcScCrossoverCo:h.VcScCrossoverCo,VcScCrossoverGr:h.VcScCrossoverGr,VcTradeshow:h.VcTradeshow,ScAiSubgradeCentre:h.ScAiSubgradeCentre,ScAiSubgradeCorner:h.ScAiSubgradeCorner,ScAiSubgradeEdge:h.ScAiSubgradeEdge,ScAiSubgradeSurface:h.ScAiSubgradeSurface,ScAiSubgradeAuto:h.ScAiSubgradeAuto};c.push(V);var b=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZODATA_CHARACTERISTCS_GRADENEW_SRV/");var w=this;b.create("/Grade_MARADATASet",V,{method:"POST",success:function(e){if(e.ImFlag=="E"){r.error("Collectable ID is In-active")}else{w.SaveGradeHistoryData().then(function(t){var i=e.MESSAGE;a.show("Data Saved Succesfully");w.getNextLineItem("P").then(function(e){w.onFetchDetailsValidate(e)},true)})}},error:function(e){}})},onGetMaraDatacallp:function(e){var t=new sap.ui.model.json.JSONModel;var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=this.getOwnerComponent().getModel("SC");var r=this.getView().getModel("SC_pInitModel").getData();var d=" ";if(this.LineId==r[0].Posnr){d="X"}if(d!=="X"){this.getView().byId("SC_idSportsCard").setValue(" ");this.getView().byId("SC_idInputManuf").setValue(" ");this.getView().byId("SC_idSetCode").setValue(" ");this.getView().byId("SC_idPlayer").setValue(" ");this.getView().byId("SC_idSubset").setValue(" ");this.getView().byId("SC_idInputCardNo").setValue(" ");this.getView().byId("SC_idInputNota").setValue(" ");this.getView().byId("SC_idInputPedig").setValue(" ");this.getView().byId("SC_idInputCollId").setValue(" ");this.getView().byId("SC_idBump").setSelectedKey("");this.getView().byId("SC_idInputYear").setValue(" ");this.getView().byId("SC_idInputAttr1").setValue(" ");this.getView().byId("SC_idInputAttr2").setValue(" ");this.getView().byId("SC_idCrossOver").setValue(" ");this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true)}this.SC_onGetGradeHistcallp();if(this.oDataMaradata){if(this.oDataMaradata.length!==0){this.Collid=this.oDataMaradata[0].CollectibleId;this.VcScCrossover=" ";this.VcScCrossover=this.oDataMaradata[0].VcScCrossover;if(this.oDataMaradata[0].ZThickHolderFlag==="X"){this.getView().byId("SC_idTH").setSelected(true)}else{this.getView().byId("SC_idTH").setSelected(false)}if(this.oDataMaradata[0].FactoryAutograph==="X"){this.getView().byId("SC_idInputAuto").setSelected(true)}else{this.getView().byId("SC_idInputAuto").setSelected(false)}if(this.oDataMaradata[0].NoGrade!==""){this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false)}if(this.oDataMaradata[0].NoGrade===""){this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true)}}this.getView().getModel("SC_MaraDataModel").setData(this.oDataMaradata[0]);this.getView().getModel("SC_MaraDataModel").refresh()}this.SC_getImage()},onGetMaraDatacall:function(e){var t=this.getView().getModel("SC_pInitModel").getData();var i=new sap.ui.model.json.JSONModel;var s=new sap.ui.model.json.JSONModel;var a=this.getOwnerComponent().getModel("SC");var r=this.getOwnerComponent().getModel("SC");var d=" ";if(this.getView().byId("SC_idFinish").getSelected()===true){d="X"}if(this.getView().byId("SC_idFinish").getSelected()!==true){for(var l=0;l<t.length;l++){if(l==t.length-1){var o=t[l];if(this.LineId==o.Posnr){d="X"}}}}if(d!=="X"){this.getView().byId("SC_idSportsCard").setValue(" ");this.getView().byId("SC_idInputManuf").setValue(" ");this.getView().byId("SC_idSetCode").setValue(" ");this.getView().byId("SC_idPlayer").setValue(" ");this.getView().byId("SC_idSubset").setValue(" ");this.getView().byId("SC_idInputCardNo").setValue(" ");this.getView().byId("SC_idInputNota").setValue(" ");this.getView().byId("SC_idInputPedig").setValue(" ");this.getView().byId("SC_idInputCollId").setValue(" ");this.getView().byId("SC_idBump").setSelectedKey("");this.getView().byId("SC_idInputYear").setValue(" ");this.getView().byId("SC_idInputAttr1").setValue(" ");this.getView().byId("SC_idInputAttr2").setValue(" ");this.getView().byId("SC_idCrossOver").setValue(" ");this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true)}this.SC_onGetGradeHistcall();if(this.oDataMaradata){if(this.oDataMaradata.length!==0){this.Collid=this.oDataMaradata[0].CollectibleId;this.VcScCrossover=" ";this.VcScCrossover=this.oDataMaradata[0].VcScCrossover;if(this.oDataMaradata[0].ZThickHolderFlag==="X"){this.getView().byId("SC_idTH").setSelected(true)}else{this.getView().byId("SC_idTH").setSelected(false)}if(this.oDataMaradata[0].FactoryAutograph==="X"){this.getView().byId("SC_idInputAuto").setSelected(true)}else{this.getView().byId("SC_idInputAuto").setSelected(false)}if(this.oDataMaradata[0].NoGrade!==""){this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false)}if(this.oDataMaradata[0].NoGrade===""){this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true)}}this.getView().getModel("SC_MaraDataModel").setData(this.oDataMaradata[0]);this.getView().getModel("SC_MaraDataModel").refresh()}this.SC_getImage()},SC_onGetGradeHistcallp:function(e){var t=new sap.ui.model.json.JSONModel;var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var r=this.getOwnerComponent().getModel("SC");var d=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"P")];r.read("/Grade_gradehistorySet",{filters:d,success:function(e,t){i.setData(e);if(e.results.length!==0){this.GradeChek_SC=e.results[0].gradedec;if(e.results[0].Perfect10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PERFECT");this.perfectchk="S"}else if(e.results[0].Pristine10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PRISTINE")}else{}if(e.results[0].GradeComplete==="X"){this.getView().byId("SC_idFinish").setSelected(true);this.getView().byId("SC_idExit").setEnabled(false);this.getView().byId("SC_idInputCollId").setEnabled(false);this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false);this.getView().byId("SC_idNoGrade").setEnabled(false);this.getView().byId("SC_idBump").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done");this.SetLineItem(e.results[0].Posnr)}else{this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("SC_idExit").setEnabled(true);this.getView().byId("SC_idInputCollId").setEnabled(true);this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true);this.getView().byId("SC_idBump").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false)}else{this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true)}this.setSaveNxtPreDisabled(e.results[0])}this.getView().getModel("SC_GradHistModel").setData(e.results);this.getView().getModel("SC_GradHistModel").refresh()}.bind(this),error:function(){}})},SC_onGetGradeHistcall:function(e){var t=new sap.ui.model.json.JSONModel;var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var r=this.getOwnerComponent().getModel("SC");var d=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"N")];r.read("/Grade_gradehistorySet",{filters:d,success:function(e,t){i.setData(e);if(e.results.length!==0){this.GradeChek_SC=e.results[0].gradedec;if(e.results[0].Perfect10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PERFECT");this.perfectchk="S"}else if(e.results[0].Pristine10==="X"){this.getView().byId("SC_idGrade").setSelectedKey("PRISTINE")}else{}if(e.results[0].GradeComplete==="X"){this.getView().byId("SC_idFinish").setSelected(true);this.getView().byId("SC_idExit").setEnabled(false);this.getView().byId("SC_idInputCollId").setEnabled(false);this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false);this.getView().byId("SC_idNoGrade").setEnabled(false);this.getView().byId("SC_idBump").setEnabled(false);a.show("Grading is Completed for this Salesorder and No further changes can be done");this.SetLineItem(e.results[0].Posnr)}else{this.getView().byId("SC_idFinish").setSelected(false);this.getView().byId("SC_idExit").setEnabled(true);this.getView().byId("SC_idInputCollId").setEnabled(true);this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true);this.getView().byId("SC_idNoGrade").setEnabled(true);this.getView().byId("SC_idBump").setEnabled(true)}if(e.results[0].Nograde!==""){this.getView().byId("SC_idGrade").setEnabled(false);this.getView().byId("SC_idAutoGrade").setEnabled(false)}else{this.getView().byId("SC_idGrade").setEnabled(true);this.getView().byId("SC_idAutoGrade").setEnabled(true)}this.getView().getModel("SC_GradHistModel").setData(e.results);this.getView().getModel("SC_GradHistModel").refresh();this.setSaveNxtPreDisabled(e.results[0])}}.bind(this),error:function(){}})},SC_onMissedCall:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"M")];i.read("/getInitialLineItemsSet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){var s=e.results[0].ExCount;var a=e.results.length;var r="Missed Gradings";var d=r.concat("(",s,"/",a,")");this.getView().byId("SC_idMsdGradTab").setText(d);e.results.sort(function(e,t){return e.Posnr-t.Posnr})}this.getView().byId("SC_idMsdGradTab").setText(d);this.getView().getModel("SC_InitModel").setData(e.results);this.getView().getModel("SC_InitModel").refresh()}.bind(this),error:function(){}})},SC_onPerSelect:function(e){if(this.getView().byId("SC_idPerChk").getSelected()==true){var t=new sap.ui.model.json.JSONModel;t={kgrade:this.getView().byId("SC_idGrade").getSelectedText(),lgrade:this.getView().byId("SC_idGrade").getValue()};this.getView().setModel(t,"SC_DataModel");this.getView().byId("SC_idGrade").setValue("Perfect 10");this.getView().byId("SC_idGrade").setSelectedKey("PERFECT")}if(this.getView().byId("SC_idPerChk").getSelected()===false){if(this.perfectchk!=="S"){var i=this.getView().getModel("SC_DataModel").lgrade;var s=this.getView().getModel("SC_DataModel").lcenter;var a=this.getView().getModel("SC_DataModel").lcorner;var r=this.getView().getModel("SC_DataModel").ledge;var d=this.getView().getModel("SC_DataModel").lsurface;var l=this.getView().getModel("SC_DataModel").kgrade;var o=this.getView().getModel("SC_DataModel").kcenter;var n=this.getView().getModel("SC_DataModel").kcorner;var g=this.getView().getModel("SC_DataModel").kedge;var u=this.getView().getModel("SC_DataModel").ksurface}this.perfectchk=" ";this.getView().byId("SC_idGrade").setValue("");this.getView().byId("SC_idGrade").setSelectedKey("")}},onValueTCCollectable:function(){this.oModel.read("/ZMMSearchHelp_TCSet",{urlParameters:{$top:"20",$skip:"10"},success:function(e,t){this.setCollectabledata_TC(e.results)}.bind(this),error:function(){a.show("Failed to Load Data")}});var e=this,t=this.getView();if(!e.cDialog_TC){e.cDialog_TC=d.load({name:"ccgtradingcards.view.fragment.collectible_TC",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.cDialog_TC.then(function(e){e.open()})},setCollectabledata_TC:function(e){var t=new sap.ui.model.json.JSONModel(e);this.getView().setModel(t,"oDataCollectable_TC")},SC_onValueHelpRequested:function(){var e=new sap.ui.model.json.JSONModel;var t=this.getOwnerComponent().getModel("SC");t.read("/Grade_setcodeSet",{success:function(t,i){e.setData(t);t.results.unshift(" ");this.getView().getModel("SC_SetCodeModel").setData(t.results);this.getView().getModel("SC_SetCodeModel").refresh()}.bind(this),error:function(){}});t.read("/ZmmSearchHelpSet",{success:function(t,i){e.setData(t);this.getView().getModel("SC_CollectibleModel").setData(t.results);this.getView().getModel("SC_CollectibleModel").refresh()}.bind(this),error:function(){a.show("Failed to Load Data")}});var i=this,s=this.getView();if(!i.cDialog_SC){i.cDialog_SC=d.load({name:"ccgtradingcards.view.fragment.collectible",controller:i}).then(function(e){s.addDependent(e);return e}.bind(i))}i.cDialog_SC.then(function(e){e.open()})},onValueHelpCancelPress:function(){this._oValueHelpDialog.close()},onValueHelpAfterClose:function(){this._oValueHelpDialog.close()},handleOkDlogPress_TC:function(e){var t=sap.ui.getCore().byId("TC_idGradeTablef");var i=t.getSelectedIndices();if(i.length==0){r.error("No Collectible Row is selected")}else{this.getView().getModel("MainModel").getData().CardName=this.selectedRow.CARD_NAME;this.getView().getModel("MainModel").getData().Gamedescription=this.selectedRow.GAME_CODE;this.getView().getModel("MainModel").getData().Variant1desc=this.selectedRow.VARIANT_CODE1;this.getView().getModel("MainModel").getData().Variant2desc=this.selectedRow.VARIANT_CODE2;this.getView().getModel("MainModel").getData().Langdescription=this.selectedRow.LANG_CODE;this.getView().getModel("MainModel").getData().SetCode="";this.getView().getModel("MainModel").getData().Raritydescription=this.selectedRow.RARITY_CODE;this.getView().getModel("MainModel").getData().Matnr=this.selectedRow.MATNR;this.getView().getModel("MainModel").getData().Aicenter=this.selectedRow.CARD_YEAR;this.getView().getModel("MainModel").refresh();sap.ui.getCore().byId("TC_idInputRarity").setValue("");sap.ui.getCore().byId("TC_idInputVart1").setValue("");sap.ui.getCore().byId("TC_idInputVart2").setValue("");this.onCloseDialog_TC();this.getView().getModel("oDataCollectable_TC").setData([]);this.getView().getModel().refresh()}},handleOkDlogPress:function(e){var t=sap.ui.getCore().byId("SC_idGradeTablef");var i=t.getSelectedIndices();if(i.length==0){r.error("No Collectible Row is selected")}else{var s=this;s.onCloseDialog()}this.onValueHelpAfterClose()},handleRefreshPress:function(e){sap.ui.getCore().byId("SC_idSportsCardf").setSelectedKey("");sap.ui.getCore().byId("SC_idInputManuff").setSelectedKey("");sap.ui.getCore().byId("SC_idSetCodef").setSelectedKey("");sap.ui.getCore().byId("SC_idPlayerf").setValue(" ");sap.ui.getCore().byId("SC_idMaterialf").setValue(" ");sap.ui.getCore().byId("SC_idInputYearf").setValue(" ");sap.ui.getCore().byId("SC_idInputAttr1f").setValue(" ");sap.ui.getCore().byId("SC_idInputAttr2f").setValue(" ");var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");i.read("/ZmmSearchHelpSet",{success:function(e,i){t.setData(e);this.getView().getModel("SC_CollectibleModel").setData(e.results);this.getView().getModel("SC_CollectibleModel").refresh()}.bind(this),error:function(){a.show("Error in Loading Data, Please Contact Technical Team")}})},handleGoDlogPress_TC:function(){var e=[];var t=sap.ui.getCore().byId("TC_idInputGameCode").getValue();if(t){e.push(new sap.ui.model.Filter("GAME_CODE",sap.ui.model.FilterOperator.EQ,t))}var i=sap.ui.getCore().byId("TC_idInputLanguage").getValue();if(i){e.push(new sap.ui.model.Filter("LANG_CODE",sap.ui.model.FilterOperator.EQ,i))}var s=sap.ui.getCore().byId("TC_idInputSetCode").getValue();if(s){e.push(new sap.ui.model.Filter("SET_CODE",sap.ui.model.FilterOperator.EQ,s))}var r=sap.ui.getCore().byId("TC_Card_Name").getValue();if(r){e.push(new sap.ui.model.Filter("CARD_NAME",sap.ui.model.FilterOperator.EQ,r))}var d=sap.ui.getCore().byId("TC_Display_Name").getValue();if(d){e.push(new sap.ui.model.Filter("DISPLAY_NAME",sap.ui.model.FilterOperator.EQ,d))}var l=sap.ui.getCore().byId("TC_Label_Text").getValue();if(l){e.push(new sap.ui.model.Filter("LABEL_TEXT",sap.ui.model.FilterOperator.EQ,l))}var o=sap.ui.getCore().byId("TC_Web_lookup").getValue();if(o){e.push(new sap.ui.model.Filter("WEBLOOKUP",sap.ui.model.FilterOperator.EQ,o))}var n=sap.ui.getCore().byId("TC_Year").getValue();if(n){e.push(new sap.ui.model.Filter("CARD_YEAR",sap.ui.model.FilterOperator.EQ,n))}var g=sap.ui.getCore().byId("TC_idInputVart1").getValue();if(g){e.push(new sap.ui.model.Filter("VARIANT_CODE1",sap.ui.model.FilterOperator.EQ,g))}var u=sap.ui.getCore().byId("TC_idInputVart2").getValue();if(u){e.push(new sap.ui.model.Filter("VARIANT_CODE2",sap.ui.model.FilterOperator.EQ,u))}var h=sap.ui.getCore().byId("TC_idInputRarity").getValue();if(h){e.push(new sap.ui.model.Filter("RARITY_CODE",sap.ui.model.FilterOperator.EQ,h))}var C=sap.ui.getCore().byId("TC_Color_code").getValue();if(C){e.push(new sap.ui.model.Filter("COLOR_CODE",sap.ui.model.FilterOperator.EQ,C))}var S=sap.ui.getCore().byId("TC_Exclude_from_OSF").getSelectedKey();if(S){e.push(new sap.ui.model.Filter("EXCLUDE_FROM_OSF",sap.ui.model.FilterOperator.EQ,S))}var c=sap.ui.getCore().byId("TC_Exclude_from_POP").getSelectedKey();if(c){e.push(new sap.ui.model.Filter("EXCLUDE_POP_REPORT",sap.ui.model.FilterOperator.EQ,c))}var V=sap.ui.getCore().byId("TC_X_Plant_Mat_Status").getValue();if(V){e.push(new sap.ui.model.Filter("MSTAE",sap.ui.model.FilterOperator.EQ,V))}var b=sap.ui.getCore().byId("Card_Number").getValue();if(b){e.push(new sap.ui.model.Filter("COLLECTOR_NUM",sap.ui.model.FilterOperator.EQ,b))}this.oModel.read("/ZMMSearchHelp_TCSet",{filters:e,success:function(e,t){this.setCollectabledata_TC(e.results)}.bind(this),error:function(){a.show("No Data for this Search")}})},handleGoDlogPress:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=sap.ui.getCore().byId("SC_idSportsCardf").getSelectedKey();var r=sap.ui.getCore().byId("SC_idInputManuff").getSelectedKey();var d=sap.ui.getCore().byId("SC_idSetCodef").getSelectedKey();var l=sap.ui.getCore().byId("SC_idInputYearf").getSelectedKey();var o=sap.ui.getCore().byId("SC_idPlayerf")._lastValue;var n=sap.ui.getCore().byId("SC_idMaterialf")._lastValue;var g=sap.ui.getCore().byId("SC_idInputAttr1f")._lastValue;var u=sap.ui.getCore().byId("SC_idInputAttr2f")._lastValue;if(n==" "&&s==" "&&r==" "&&d==" "&&l==" "&&o==" "&&g==" "&&u==" "){i.read("/ZmmSearchHelpSet",{success:function(e,i){t.setData(e);this.getView().getModel("SC_CollectibleModel").setData(e.results);this.getView().getModel("SC_CollectibleModel").refresh()}.bind(this),error:function(){a.show("Failed to Load Data, Refresh Again")}})}else{var h=[new sap.ui.model.Filter("Matnr",sap.ui.model.FilterOperator.EQ,n),new sap.ui.model.Filter("ZSportscodeText",sap.ui.model.FilterOperator.EQ,s),new sap.ui.model.Filter("ZMakercodeText",sap.ui.model.FilterOperator.EQ,r),new sap.ui.model.Filter("ZCardsetText",sap.ui.model.FilterOperator.EQ,d),new sap.ui.model.Filter("ZCardYear",sap.ui.model.FilterOperator.EQ,l),new sap.ui.model.Filter("ZSubjectDescription",sap.ui.model.FilterOperator.EQ,o),new sap.ui.model.Filter("ZCsgCardAttrib1Descr",sap.ui.model.FilterOperator.EQ,g),new sap.ui.model.Filter("ZCsgCardAttrib2Descr",sap.ui.model.FilterOperator.EQ,u)];i.read("/ZmmSearchHelpSet",{filters:h,success:function(e,i){t.setData(e);this.getView().getModel("SC_CollectibleModel").setData(e.results);this.getView().getModel("SC_CollectibleModel").refresh()}.bind(this),error:function(){a.show("No Data for this Search")}})}this.onValueHelpAfterClose()},onCloseDialog:function(e){sap.ui.getCore().byId("SC_idSportsCardf").setSelectedKey(" ");sap.ui.getCore().byId("SC_idInputManuff").setSelectedKey(" ");sap.ui.getCore().byId("SC_idSetCodef").setSelectedKey(" ");sap.ui.getCore().byId("SC_idInputYearf").setValue(" ");sap.ui.getCore().byId("SC_idPlayerf").setValue(" ");sap.ui.getCore().byId("SC_idMaterialf").setValue(" ");sap.ui.getCore().byId("SC_colDialog").close()},onCloseDialog_TC:function(){sap.ui.getCore().byId("TC_colDialog").close();this.getView().getModel("oDataCollectable_TC").setData([]);this.getView().getModel("oDataCollectable_TC").refresh()},action_TC:function(e){this.selectedRow=e.getSource().getModel("oDataCollectable_TC").getData()[e.getSource().getSelectedIndex()];var t=this;var i=[new sap.ui.model.Filter({path:"NameChar",operator:sap.ui.model.FilterOperator.EQ,value1:this.selectedRow.MATNR})];this.oModel.read("/Grade_nogradeSet",{filters:i,success:function(e,i){t.setAutoGraphValidation(e.results[0].NameChar)}})},action:function(e){var t=e.getParameters().rowContext.getPath();var i=e.getParameters().rowContext.getModel("CollectibleModel").getProperty(t);var s=i.Matnr;var a=i.ZCsgSetCode;this.LineId=this.getView().byId("SC_idGradLine").getText();this.CollectId=s;var r=new sap.ui.model.json.JSONModel;var d=this.getOwnerComponent().getModel("SC");var l=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"C"),new sap.ui.model.Filter("ImCollectid",sap.ui.model.FilterOperator.EQ,this.CollectId)];var o=this.getView().byId("SC_idBump").getSelectedKey();d.read("/Grade_MARADATASet",{filters:l,success:function(e,t){r.setData(e);if(e.results.length!==0){this.Collid=e.results[0].CollectibleId}if(e.results.length!==0){if(e.results[0].ZThickHolderFlag==="X"){this.getView().byId("SC_idTH").setSelected(true)}else{this.getView().byId("SC_idTH").setSelected(false)}if(e.results[0].FactoryAutograph==="X"){this.getView().byId("SC_idInputAuto").setSelected(true)}else{this.getView().byId("SC_idInputAuto").setSelected(false)}e.results[0].Bump=o}this.getView().getModel("SC_MaraDataModel").setData(e.results[0]);this.getView().getModel("SC_MaraDataModel").refresh()}.bind(this),error:function(){}});var n=new sap.ui.model.json.JSONModel;this.getView().setModel(n,"SC_SubsetModel");n.setSizeLimit(3e3);var g=[new sap.ui.model.Filter("CsgCardSetCode",sap.ui.model.FilterOperator.EQ,a)];d.read("/ZmmSubsetsrchSet",{filters:g,success:function(e,t){r.setData(e);e.results.unshift(" ");this.getView().getModel("SC_SubsetModel").setData(e.results);this.getView().getModel("SC_SubsetModel").refresh()}.bind(this),error:function(){}})},SC_onPrintBox:function(e){this.LineId=this.getView().byId("SC_idGradLine").getText();var t=this.getView().getModel().sServiceUrl;var i=t+"/FILE_PDFDISPLAYSet(Vbeln='"+this.SalesId+"',Posnr='"+this.LineId+"',Box='YES')/$value";window.open(i)},onCollectEnter:function(e){this.CollectId=this.getView().byId("SC_idInputCollId").getText();var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("LvPosnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"C"),new sap.ui.model.Filter("ImCollectid",sap.ui.model.FilterOperator.EQ,this.CollectId)];var a=this.getView().byId("SC_idBump").getSelectedKey();i.read("/Grade_MARADATASet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){this.Collid=e.results[0].CollectibleId}e.results[0].Bump=a;if(e.results.length!==0){if(e.results[0].ZThickHolderFlag==="X"){this.getView().byId("SC_idTH").setSelected(true)}else{this.getView().byId("SC_idTH").setSelected(false)}if(e.results[0].FactoryAutograph==="X"){this.getView().byId("SC_idInputAuto").setSelected(true)}else{this.getView().byId("SC_idInputAuto").setSelected(false)}}this.getView().getModel("SC_MaraDataModel").setData(e.results[0]);this.getView().getModel("SC_MaraDataModel").refresh()}.bind(this),error:function(){}})},SC_OnGradeSel:function(e){var t=this;var i=this.getView().byId("SC_idGrade").getValue();var s=this.getView().getModel("GradeSetModel").getData();if(!isNaN(parseFloat(i))&&isFinite(i)){s.every(e=>{if(e.CharValue==i){t.GradeValidationSC=" ";return false}else{t.GradeValidationSC="X";return true}});if(t.GradeValidationSC=="X"){r.error("Please select the valid Grade");t.getView().byId("idGrade").setSelectedKey("");t.getView().byId("idGrade").setValue("")}else{var a=e.getParameters().newValue;var d=this.getView().byId("SC_idNoGrade").getSelectedKey();if(this.VcScCrossover!=""){if(d==""){if(this.VcScCrossover>=a){var l="Grade should be more than Crossover ";var o=l.concat(this.VcScCrossover);r.information(o)}}}}}else{r.error("Characters are not allowed in Grade. please select from dropdown",{onClose:function(e){t.getView().byId("SC_idGrade").setSelectedKey("");t.getView().byId("SC_idGrade").setValue("")}})}},OnGradeSelCng:function(e){var t=this;var i=this.getView().byId("SC_idGrade").getValue();if(!isNaN(parseFloat(i))&&isFinite(i)){this.SC_kgrade=e.getParameters().selectedItem.getText();var s=e.getParameter("selectedItem").getAdditionalText();this.getView().getModel("SC_MaraDataModel").getData().ErrorMessage=s;this.getView().getModel("SC_MaraDataModel").getData().Grade=this.SC_kgrade;this.getView().getModel("SC_MaraDataModel").refresh();if(this.SC_kgrade=="10"&&(s=="PRISTINE"||s=="Pristine")){this.GradeChek_SC="PRISTINE"}else if(this.SC_kgrade=="10"&&(s=="PERFECT"||s=="Perfect")){this.GradeChek_SC="PERFECT"}else if(this.SC_kgrade=="10"){this.GradeChek_SC="GEM MINT"}}},SC_onGradCompleteSelect:function(e){var t=this;if(this.getView().byId("SC_idFinish").getSelected()===false){r.warning("You are Revoking the Grade Completion status, Click OK & Save to continue",{actions:[r.Action.OK,r.Action.CANCEL],emphasizedAction:r.Action.OK,onClose:function(e){if(e==="OK"){var i=new sap.ui.model.json.JSONModel;var s=t.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,t.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,t.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"D")];s.read("/getInitialLineItemsSet",{filters:a,success:function(e,s){i.setData(e);t.GradeCompleted_SC=" ";t.getView().byId("SC_idExit").setEnabled(true);t.getView().byId("SC_idPrevious").setEnabled(true);t.getView().byId("SC_idNext").setEnabled(true);t.getView().byId("SC_idInputCollId").setEnabled(true);t.getView().byId("SC_idGrade").setEnabled(true);t.getView().byId("SC_idAutoGrade").setEnabled(true);t.getView().byId("SC_idNoGrade").setEnabled(true);t.getView().byId("SC_idBump").setEnabled(true)}.bind(this),error:function(){}})}}})}if(this.getView().byId("SC_idFinish").getSelected()===true){this.LineId=this.getView().byId("SC_idGradLine").getText();var i=this.getView().byId("SC_idGrade").getSelectedText();var s=this.getView().byId("SC_idNoGrade").getSelectedKey();var a=new sap.ui.model.json.JSONModel;var d=this.getOwnerComponent().getModel("SC");var l=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId),new sap.ui.model.Filter("ImFlag",sap.ui.model.FilterOperator.EQ,"G")];d.read("/getInitialLineItemsSet",{filters:l,success:function(e,d){a.setData(e);if(e.results.length!==0){if(e.results[0].Posnr!==""&&i===""||e.results[0].Posnr!==""&&s===""){var l="There are ungraded items on this order against the item no ";var o=this.LineId;var n=l.concat(o);this.getView().byId("SC_idFinish").setSelected(false);r.error(n)}}else{var g;var u=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId)];r.confirm("Do you want to complete the Grading for this order?, click OK & Save to confirm",{actions:[r.Action.OK,r.Action.CANCEL],emphasizedAction:r.Action.OK,onClose:function(e){if(e==="OK"){t.GradeCompleted_SC="X";t.getView().byId("SC_idPrevious").setEnabled(false);t.getView().byId("SC_idNext").setEnabled(false);t.getView().byId("SC_idGrade").setEnabled(false);t.onSave()}if(e==="CANCEL"){t.getView().byId("SC_idFinish").setSelected(false)}}})}}.bind(this),error:function(){}})}},SC_onGraderInfoClik:function(e){var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"SC_GraderInfoModel");var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,this.SalesId),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,this.LineId)];s.read("/getGraderInfoSet",{filters:a,success:function(e,t){i.setData(e);if(e.results.length!==0){this.giCount=e.results[0].ExCount;sap.ui.getCore().byId("SC_idGraderInfLbl").setValue(this.giCount)}this.getView().getModel("SC_GraderInfoModel").setData(e.results);this.getView().getModel("SC_GraderInfoModel").refresh()}.bind(this),error:function(){}});var r=this,l=this.getView();if(!r.gdrInfoDialog_SC){r.gdrInfoDialog_SC=d.load({name:"ccgtradingcards.view.fragment.SC_GraderInfo",controller:r}).then(function(e){l.addDependent(e);return e}.bind(r))}r.gdrInfoDialog_SC.then(function(e){e.open()})},SC_onDispStatus:function(e){var t=new sap.ui.model.json.JSONModel;this.getView().setModel(t,"SC_userStatusModel");var i=new sap.ui.model.json.JSONModel;var s=this.getOwnerComponent().getModel("SC");var a=[new sap.ui.model.Filter("LvVbeln",sap.ui.model.FilterOperator.EQ,this.SalesId)];s.read("/UserStatusSet",{filters:a,success:function(e,t){i.setData(e);this.getView().getModel("SC_userStatusModel").setData(e.results);this.getView().getModel("SC_userStatusModel").refresh()}.bind(this),error:function(){}});this.uDialog=d.load({name:"ccgtradingcards.view.fragment.SC_Userstatus",controller:this}).then(function(e){this.getView().addDependent(e);e.open()}.bind(this))},SC_onMoreImages:function(e){var t=new sap.ui.model.json.JSONModel;var i=this.getOwnerComponent().getModel("SC");var s=[new sap.ui.model.Filter("CertType",sap.ui.model.FilterOperator.EQ,"I"),new sap.ui.model.Filter("CertId",sap.ui.model.FilterOperator.EQ,this.Collid)];i.read("/Image_displaySet",{filters:s,success:function(e,i){t.setData(e);if(e.results.length!==0){this.s3Url=e.results[0].FrontUrl;window.open(this.s3Url)}}.bind(this),error:function(){}})},SC_OnGraderClose:function(e){sap.ui.getCore().byId("SC_GradDialog").close()},SC_OnUserClose:function(e){sap.ui.getCore().byId("SC_UserDialog").close()},SC_onNoGradeChange:function(e){var t=this.getView().byId("SC_idNoGrade").getSelectedKey();},onPristineSelect:function(e){if(this.getView().byId("SC_idPristineChk").getSelected()==true){this.getView().byId("SC_idGrade").setValue("Pristine 10");this.getView().byId("SC_idGrade").setSelectedKey("10");this.getView().byId("SC_idPerChk").setSelected(false)}else{this.getView().byId("SC_idGrade").setValue("");this.getView().byId("SC_idGrade").setSelectedKey("")}},onSignaturePress:function(){var e=this;if(e.LineId.length===1){var t="00"+e.LineId}else if(e.LineId.length===2){t="0"+e.LineId}sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(i){var s=i.hrefForExternal({target:{semanticObject:"ZSEMOBJGRAD",action:"register"},params:{SaleOrder:e.SalesId,LineItem:t}});var a=window.location.href.split("#")[0]+s;sap.m.URLHelper.redirect(a,true)})},SetLineItem:function(e){this.getView().byId("idLineItem").setValue(e);this.getView().byId("idLineItem").setSelectedKey(e)},showBusyIndicator:function(e,t){u.show(t);if(e&&e>0){if(this._sTimeoutId){clearTimeout(this._sTimeoutId);this._sTimeoutId=null}this._sTimeoutId=setTimeout(function(){this.hideBusyIndicator()}.bind(this),e)}},hideBusyIndicator:function(){u.hide()},getLabelLine:function(e,t,i){var s=this;var a=[new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.EQ,e),new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.EQ,t)];this.oModel.read("/SignLabelLineSet",{filters:a,success:function(e,t){s.setDatatoLabelLines(e,i)},error:function(){}})},onRefreshLblLns:function(){this.getLabelLine(this.SalesId,this.LineId,this.ViewType)},setDatatoLabelLines:function(e,t){if(e.results.length>0){if(e.results[0].Labellines1)var i=e.results[0].Labellines1;if(e.results[0].Labellines2)i=i+"/n"+e.results[0].Labellines2;if(e.results[0].Labellines3)i=i+"/n"+e.results[0].Labellines3;if(e.results[0].Labellines4)i=i+"/n"+e.results[0].Labellines4;if(t==="S"){this.getView().byId("SigLblLinesID_SC").setValue(i)}else{this.getView().byId("SigLblLinesID_TC").setValue(i)}}else{if(t==="S"){this.getView().byId("SigLblLinesID_SC").setValue("")}else{this.getView().byId("SigLblLinesID_TC").setValue("")}}},onGameValueHelp:function(){var e=this,t=this.getView();if(!e.gameCodeD){e.gameCodeD=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.GameCode",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.gameCodeD.then(function(e){e.open()})},onLangValueHelp:function(){var e=this,t=this.getView();if(!e.LangCode){e.LangCode=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.LangCode",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.LangCode.then(function(e){e.open()})},onSetValueHelp:function(){var e=this,t=this.getView();if(!e.SetCode){e.SetCode=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.SetCode",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.SetCode.then(function(e){e.open()})},onVariantValueHelp:function(e){var t=this,i=this.getView();this.variantID=e.getSource().getId();if(!t.VariantCode){t.VariantCode=d.load({id:i.getId(),name:"ccgtradingcards.view.fragment.VariantCode",controller:t}).then(function(e){i.addDependent(e);return e}.bind(t))}t.VariantCode.then(function(e){e.open()})},onVariantValueHelp2:function(e){var t=this,i=this.getView();this.variantID=e.getSource().getId();if(!t.VariantCode2){t.VariantCode2=d.load({id:i.getId(),name:"ccgtradingcards.view.fragment.VariantCode",controller:t}).then(function(e){i.addDependent(e);return e}.bind(t))}t.VariantCode2.then(function(e){e.open()})},onRarityValueHelp:function(){var e=this,t=this.getView();if(!e.Rarity){e.Rarity=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.Rarity",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.Rarity.then(function(e){e.open()})},onColorValueHelp:function(){var e=this,t=this.getView();if(!e.Color){e.Color=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.ColorCode",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.Color.then(function(e){e.open()})},onXPMSValueHelp:function(){var e=this,t=this.getView();if(!e.XPMS){e.XPMS=d.load({id:t.getId(),name:"ccgtradingcards.view.fragment.XPMS",controller:e}).then(function(e){t.addDependent(e);return e}.bind(e))}e.XPMS.then(function(e){e.open()});var i=[];i.push(new sap.ui.model.Filter("Mmsta",sap.ui.model.FilterOperator.NE,""));i.push(new sap.ui.model.Filter("Mtstb",sap.ui.model.FilterOperator.NE,""));var s=this.GetTradingCardValueHelp("/HT141Set",i,"XPMS")},onButtonGameSearch:function(){var e=[];var t=this.getView().byId("gameCode_GC").getValue();e.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,t));var i=this.getView().byId("Active_GC").getValue();if(i){e.push(new sap.ui.model.Filter("Active",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("NameSearch").getValue();if(s){e.push(new sap.ui.model.Filter("GameNameSearch",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("MakerFlag").getValue();if(a){e.push(new sap.ui.model.Filter("MakerFlag",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("Name").getValue();if(r){e.push(new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,r))}var d=this.GetTradingCardValueHelp("/ZmmCardgamecodeSet",e,"GameModel")},onButtonLangSearch:function(){var e=[];var t=this.getView().byId("LangCode_LC").getValue();if(t){e.push(new sap.ui.model.Filter("LangCode",sap.ui.model.FilterOperator.Contains,t))}var i=this.getView().byId("GameCode_LC").getValue();if(i){e.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("LAF_LC").getValue();if(s){e.push(new sap.ui.model.Filter("LanguageActive",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("Language_name_LC").getValue();if(a){e.push(new sap.ui.model.Filter("LanguageName",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("LanguageSearch").getValue();if(r){e.push(new sap.ui.model.Filter("LanguageSearchTxt",sap.ui.model.FilterOperator.Contains,r))}var d=this.GetTradingCardValueHelp("/ZmmCardlangcodeSet",e,"LangModel")},onButtonSetSearch:function(){var e=[];var t=this.getView().byId("LangCode_SC").getValue();if(t){e.push(new sap.ui.model.Filter("LangCode",sap.ui.model.FilterOperator.Contains,t))}var i=this.getView().byId("GameCode_SC").getValue();if(i){e.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("MakerCode_SC").getValue();if(s){e.push(new sap.ui.model.Filter("MakerCode",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("SetCode_SC").getValue();if(a){e.push(new sap.ui.model.Filter("SetCode",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("GameSetActive_SC").getValue();if(r){e.push(new sap.ui.model.Filter("SetActive",sap.ui.model.FilterOperator.Contains,r))}var d=this.getView().byId("SuperSet_SC").getValue();if(d){e.push(new sap.ui.model.Filter("SupersetFlag",sap.ui.model.FilterOperator.Contains,d))}var l=this.getView().byId("SetName_SC").getValue();if(l){e.push(new sap.ui.model.Filter("SetName",sap.ui.model.FilterOperator.Contains,l))}var o=this.getView().byId("SetLblTxt_SC").getValue();if(o){e.push(new sap.ui.model.Filter("SetLabelText",sap.ui.model.FilterOperator.Contains,o))}var n=this.getView().byId("SetNameSearch_SC").getValue();if(n){e.push(new sap.ui.model.Filter("SetNameSearchTxt",sap.ui.model.FilterOperator.Contains,n))}var g=this.GetTradingCardValueHelp("/ZmmCgsetcodeSet",e,"SetModel")},onButtonVariantSearch:function(){var e=[];var t=this.getView().byId("VariantCode_VC").getValue();if(t){e.push(new sap.ui.model.Filter("VariantCode",sap.ui.model.FilterOperator.Contains,t))}var i=this.getView().byId("LangCode_VC").getValue();if(i){e.push(new sap.ui.model.Filter("LangCode",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("GameCode_VC").getValue();if(s){e.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("VariantActive_VC").getValue();if(a){e.push(new sap.ui.model.Filter("VariantActive",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("VariantName_VC").getValue();if(r){e.push(new sap.ui.model.Filter("VariantName",sap.ui.model.FilterOperator.Contains,r))}var d=this.getView().byId("VariantLblTxt_VC").getValue();if(d){e.push(new sap.ui.model.Filter("VariantLabelTxt",sap.ui.model.FilterOperator.Contains,d))}var l=this.getView().byId("VariantNameSearch_VC").getValue();if(l){e.push(new sap.ui.model.Filter("VariantNameSrch",sap.ui.model.FilterOperator.Contains,l))}var o=this.GetTradingCardValueHelp("/ZmmCgvariantSet",e,"VariantModel")},onButtonRaritySearch:function(e){var t=[];var i=this.getView().byId("RarityCode_RC").getValue();if(i){t.push(new sap.ui.model.Filter("RarityCode",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("LangCode_RC").getValue();if(s){t.push(new sap.ui.model.Filter("LangCode",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("GameCode_RC").getValue();if(a){t.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("RarityActive_RC").getValue();if(r){t.push(new sap.ui.model.Filter("RarityActive",sap.ui.model.FilterOperator.Contains,r))}var d=this.getView().byId("RarityName_RC").getValue();if(d){t.push(new sap.ui.model.Filter("RarityName",sap.ui.model.FilterOperator.Contains,d))}var l=this.getView().byId("RarityLblTxt_RC").getValue();if(l){t.push(new sap.ui.model.Filter("RarityLabelText",sap.ui.model.FilterOperator.Contains,l))}var o=this.getView().byId("RarityNameSearch_RC").getValue();if(o){t.push(new sap.ui.model.Filter("RaritySearchTxt",sap.ui.model.FilterOperator.Contains,o))}var n=this.GetTradingCardValueHelp("/ZmmCgraritycodSet",t,"RarityModel")},onButtonColorSearch:function(){var e=[];var t=this.getView().byId("ColorCode_CC").getValue();if(t){e.push(new sap.ui.model.Filter("ColorCode",sap.ui.model.FilterOperator.Contains,t))}var i=this.getView().byId("LangCode_CC").getValue();if(i){e.push(new sap.ui.model.Filter("LangCode",sap.ui.model.FilterOperator.Contains,i))}var s=this.getView().byId("GameCode_CC").getValue();if(s){e.push(new sap.ui.model.Filter("GameCode",sap.ui.model.FilterOperator.Contains,s))}var a=this.getView().byId("ColorActive_CC").getValue();if(a){e.push(new sap.ui.model.Filter("ColorActive",sap.ui.model.FilterOperator.Contains,a))}var r=this.getView().byId("ColorName_CC").getValue();if(r){e.push(new sap.ui.model.Filter("ColorName",sap.ui.model.FilterOperator.Contains,r))}var d=this.getView().byId("ColorLblTxt_CC").getValue();if(d){e.push(new sap.ui.model.Filter("ColorLabelText",sap.ui.model.FilterOperator.Contains,d))}var l=this.getView().byId("ColorNameSearch_CC").getValue();if(l){e.push(new sap.ui.model.Filter("ColorNameSrch",sap.ui.model.FilterOperator.Contains,l))}var o=this.GetTradingCardValueHelp("/ZmmCgcolorcodeSet",e,"ColorModel")},onListItemXPMSPress:function(e){var t=this;var i=e.getSource().mProperties.title;var s=e.getSource().mProperties.number;this.byId("XPMS").close();sap.ui.getCore().byId("TC_X_Plant_Mat_Status").setValue(i)},RefreshValuehelpModel:function(e){this.getView().getModel(e).setData([]);this.getView().getModel(e).refresh()},GameCode_rowSelected:function(e){this.selectedGameRow=e.getSource().getModel("GameModel").getData()[e.getSource().getSelectedIndex()];sap.ui.getCore().byId("TC_idInputGameCode").setValue(this.selectedGameRow.GameCode);this.byId("gameCode").close();this.RefreshValuehelpModel("GameModel")},LangCode_rowSelected:function(e){this.selectedLangRow=e.getSource().getModel("LangModel").getData()[e.getSource().getSelectedIndex()];sap.ui.getCore().byId("TC_idInputLanguage").setValue(this.selectedLangRow.LangCode);this.byId("LangCode").close();this.RefreshValuehelpModel("LangModel")},RarityCode_rowSelected:function(e){this.selectedRarityRow=e.getSource().getModel("RarityModel").getData()[e.getSource().getSelectedIndex()];sap.ui.getCore().byId("TC_idInputRarity").setValue(this.selectedRarityRow.RarityCode);this.byId("Rarity").close();this.RefreshValuehelpModel("RarityModel")},ColorCode_rowSelected:function(e){this.selectedColorRow=e.getSource().getModel("ColorModel").getData()[e.getSource().getSelectedIndex()];sap.ui.getCore().byId("TC_Color_code").setValue(this.selectedColorRow.ColorCode);this.byId("Color").close();this.RefreshValuehelpModel("ColorModel")},SetCode_rowSelected:function(e){this.selectedSetRow=e.getSource().getModel("SetModel").getData()[e.getSource().getSelectedIndex()];sap.ui.getCore().byId("TC_idInputSetCode").setValue(this.selectedSetRow.SetCode);this.byId("SetCode").close();this.RefreshValuehelpModel("SetModel")},variantCode1_rowSelected:function(e){this.selectedVariantRow=e.getSource().getModel("VariantModel").getData()[e.getSource().getSelectedIndex()];if(this.variantID=="TC_idInputVart1"){sap.ui.getCore().byId("TC_idInputVart1").setValue(this.selectedVariantRow.VariantCode);this.byId("VariantCode").close()}else{sap.ui.getCore().byId("TC_idInputVart2").setValue(this.selectedVariantRow.VariantCode);this.byId("VariantCode").close()}this.RefreshValuehelpModel("VariantModel")},CancelGameCode:function(){this.byId("gameCode").close();this.RefreshValuehelpModel("GameModel")},CancelLangCode:function(){this.byId("LangCode").close();this.RefreshValuehelpModel("LangModel")},CancelRarityCode:function(){this.byId("Rarity").close();this.RefreshValuehelpModel("RarityModel")},CancelColorCode:function(){this.byId("Color").close();this.RefreshValuehelpModel("ColorModel")},CancelSetCode:function(){this.byId("SetCode").close();this.RefreshValuehelpModel("SetModel")},CancelVariantCode:function(){this.byId("VariantCode").close();this.RefreshValuehelpModel("VariantModel")},GetTradingCardValueHelp:function(e,t,i){var s=this;this.oModel.read(e,{filters:t,success:function(e,t){var a=new sap.ui.model.json.JSONModel(e.results);s.getView().setModel(a,i);return e.results},error:function(e){r.error("Failed to get the Data")}})}})});